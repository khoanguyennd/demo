<?php
$sellerProductId = $this->getData('sellerProductId');
$noedit = $this->getData('noedit');
$tbridgetype1 = $this->getData('tbridgetype1');
$tbridgetype2 = $this->getData('tbridgetype2');

$type_depth = $this->getData('type_depth');
$_SESSION['type_depth'] = $type_depth;
$list_channel = $this->getData('list_channel');

$list_city = $this->getData('list_city');
$list_district = $this->getData('list_district');
$list_ward = $this->getData('list_ward');
$_SESSION['list_city'] = $list_city;
$_SESSION['list_district'] = $list_district;
$_SESSION['list_ward'] = $list_ward;

$list_sellerProduct = $this->getData('list_sellerProduct');
$pricebasic = "";
$pricerepresentative = "";

$email = $this->getData('email');
$start = date("Y-m-d");
$end = date("Y-m-d");
$list_supplier = $this->getData('list_supplier');
$list_sellerProduct = $this->getData('list_sellerProduct');
$nolimittime = 0;
$idType1="";
$idType2="";
foreach ($list_sellerProduct as $value => $giatri) {
    $travelTypeId = $giatri['travelTypeId'];
    $productDetailTypeId = $giatri['productDetailTypeId'];

    $idType1 = $giatri['idType1'];
    $idType2 = $giatri['idType2'];

    $name = $giatri['name'];

    $displayKeyword = $giatri['displayKeyword'];
    $displayCategoryCode = $giatri['displayCategoryCode'];
    $pricebasic = $giatri['pricebasic'];
    $pricerepresentative = $giatri['pricerepresentative'];

    if ($giatri ['saleStartedAt1'] != "") {
        $saleStartedAt = $giatri ['saleStartedAt1'];
        $saleEndedAt = $giatri ['saleEndedAt1'];
        $useStartedAt = $giatri ['useStartedAt1'];
        $useEndedAt = $giatri ['useEndedAt1'];
    } else {
        $saleStartedAt = $start;
        $saleEndedAt = $start;
        $useStartedAt = $start;
        $useEndedAt = $start;
    }

    $supplier = $giatri ['supplier'];
    $settlement = $giatri ['settlement'];
    $nolimittime = $giatri ['nolimittime'];
}
// echo '<pre>';
// print_r($list_city);
// echo '</pre>';
// unset($_SESSION['searchtags']);
?>
<link rel="stylesheet" type="text/css"
      href="<?= URL_PUBLIC ?>css/jsDatePick_ltr.min.css"/>
<script type="text/javascript"
        src="<?= URL_PUBLIC ?>js/jsDatePick.min.1.3.js"></script>

<script type="text/javascript">
    
    function flagChanges(){
       localStorage.setItem("flagChange", "1");
    }
    function changecity(value) {
        runAjax('changecity', {'ocity': value}, function (result) {
        	var result = JSON.parse(result);
       	    document.getElementById('district').innerHTML = result.str;
       	 	document.getElementById('ward').innerHTML = result.str1;
            //changedistrict(document.getElementById('districtId').value);
        });

    }
    function changedistrict(value) {
        runAjax('changedistrict', {'odistrict': value}, function (result) {
        	var result = JSON.parse(result);
       	    document.getElementById('ward').innerHTML = result.str;
       	 	flagChanges();
        });

    }
    function checkAllchannel(source) {
        var ids1 = document.getElementsByName("checkchannel[]");
        for (var j = 0; j < ids1.length; j++) {
            ids1[j].checked = source.checked;
        }
        //onloadsalechannel();
    }

    function checkchannel(source) {
        //onloadsalechannel();
    }
    function onloadsalechannel() {
        var channel_id = '{ ';
        var ids1 = document.getElementsByName("checkchannel[]");
        for (var j = 0; j < ids1.length; j++) {
            channel_id = channel_id + '"' + [ids1[j].value] + '" : ' + ids1[j].checked + ',';
        }
        channel_id = channel_id.substring(0, channel_id.length - 1);
        channel_id = channel_id + ' }';
        var type_id = '{ ';
        type_id = type_id + '"1" : ' + document.getElementById('type1Id').value + ',';
        type_id = type_id + '"2" : ' + document.getElementById('type2Id').value + ',';
        type_id = type_id + '"3" : ' + document.getElementById('type3Id').value + ',';
        type_id = type_id + '"4" : ' + document.getElementById('type4Id').value + '';
        type_id = type_id + ' }';
// 	console.log(channel_id);
// 	console.log(type_id);
        runAjax('onloadsalechannel', {'channel_id': channel_id, 'type_id': type_id}, function (result) {
            document.getElementById('divsalechannel').innerHTML = result;
        });

    }
    function changeChannel(value){
    	var code_depth1 = document.getElementById('type1Ids').value 
    	var code_depth2= document.getElementById('type2Ids').value;
    	runAjax('changeChannel', {'channel_id': value,'code_depth1': code_depth1,'code_depth2': code_depth2}, function (result) {
    		var result = JSON.parse(result);
            document.getElementById('otype1').innerHTML = result.otype1;
            document.getElementById('otype2').innerHTML = result.otype2;
            document.getElementById('otype3').innerHTML = result.otype3;
            document.getElementById('otype4').innerHTML = result.otype4;
            
            //changeType1(document.getElementById('type1Id').value);
            //onloadsalechannel();
        });
    }

    
    function changeType1(value) {
        runAjax('changeType1', {'id_type1': value}, function (result) {
        	var result = JSON.parse(result);
        	document.getElementById('otype2').innerHTML = result.otype2;
            document.getElementById('otype3').innerHTML = result.otype3;
            document.getElementById('otype4').innerHTML = result.otype4;
            //changeType2(document.getElementById('type2Id').value);
            //onloadsalechannel();
        });
    }

    function changeType2(value) {
    	var type1Id=document.getElementById('type1Id').value;
        runAjax('changeType2', {'id_type1': type1Id, 'id_type2': value}, function (result) {
        	var result = JSON.parse(result);
        	document.getElementById('otype3').innerHTML = result.otype3;
            document.getElementById('otype4').innerHTML = result.otype4;
            //changeType3(document.getElementById('type3Id').value);
            //onloadsalechannel();
        });

    }
    function changeType3(value) {
    	var type1Id=document.getElementById('type1Id').value;
    	var type2Id=document.getElementById('type2Id').value;
        runAjax('changeType3', {'id_type1': type1Id,'id_type2': type2Id,'id_type3': value}, function (result) {
        	var result = JSON.parse(result);
        	 document.getElementById('otype4').innerHTML = result.otype4;
            //onloadsalechannel();
        });
    }
    
    function addsalechannel() {
    	var type1Id=document.getElementById('type1Id').value;
    	var type2Id=document.getElementById('type2Id').value;
    	var type3Id=document.getElementById('type3Id').value;
    	var type4Id=document.getElementById('type4Id').value;
    	flagChanges();
    	runAjax('addsalechannel', {'id_type1': type1Id,'id_type2': type2Id,'id_type3': type3Id,'id_type4': type4Id}, function (result) {
            document.getElementById("divsalechannel").innerHTML+=result;
            if((document.getElementById("divsalechannel").innerHTML).trim()!="")
            document.getElementById("divwarnsalechannel").innerHTML= "<p># 판매채널별 수수료율은 상품카테고리에 따라 다르며, 변경될 수 있습니다.</p>";
            $('.delTypeChannel').click(function() {
            	$(this).parent().remove();
            });
        });
    }	

    $(document).ready(function () {
        $('#saveTemp').on('click', function () {
            var ff = document.nf;
            var step = $(this).attr('data-step');
            document.getElementById("step").value = step;

            if( !$.trim( $('#divsalechannel').html() ).length ) {
				 $.fn_alert(true, true, "필수 입력사항을 체크 해 주세요.");
	            return false;
	        }
            if( !$.trim( $('#divsearchtags').html() ).length ) {
				 $.fn_alert(true, true, "<?= $this->language('l_warntagsproduct1') ?>");
	            return false;
	        }
            var name = document.getElementById("name").value;
            if (name == '') {
                $.fn_alert(true, true, "<?= $this->language('l_warnproduct') ?>");
                $('#name').focus();
                return false;
            }

            ff.submit();
        });
        
        // Click link tiếp tục
        $('#continuelink').on('click', function () {     	                 
            var step = $(this).attr('data-step');
            if (step) {                
                $('#step').val(step);
                $.fn_ticketcontinue(step);
            }
        });

        // Tiếp tục thực hiện chuyển link
        $($.elt_popup).on('click', '.ticketconfirm .continue', function () {
            $.fn_ticketconfirm(false);

            if( !$.trim( $('#divsalechannel').html() ).length ) {
				 $.fn_alert(true, true, "필수 입력사항을 체크 해 주세요.");
	            return false;
	        }
            if( !$.trim( $('#divsearchtags').html() ).length ) {
				 $.fn_alert(true, true, "<?= $this->language('l_warntagsproduct1') ?>");
	            return false;
	        }
            
            var name = $("#name").val();
            if (name == '') {
                $.fn_alert(true, true, "<?= $this->language('l_warnproduct') ?>");
                $('#name').focus();
                return false;
            }
           
            $('#nf').submit();
        });
        // Thêm tags
        $('#addsearchtags').on('keypress', function (event) {
            var keycode = event.keyCode || event.which;
            if (keycode == '13') {
                var searchtags = $(this).val();
                $.fn_addsearchtags(searchtags);
            } else {
                var tags = $(this).val();
                if (tags) {
                    if (keycode == 44) {
                        if (tags.substr(-1) == ',') {
                            event.returnValue = false;
                            event.preventDefault();
                        }
                    } else {
                        var n = tags.lastIndexOf(",");
                        var tag = tags.substr(n + 1);
                        if (tag.length > 9) {
                            event.returnValue = false;
                            event.preventDefault();
                            $.fn_alert(true, true, '<?=$this->language('l_warnimage30')?>');
                        }
                    }
                }
            }
        });
        $('.addsearchtags').on('click', function () {
            localStorage.setItem("flagChange", "1");
            var searchtags = $('#addsearchtags').val();
            $.fn_addsearchtags(searchtags);
        });
        // Hàm thêm tags
        $.fn_addsearchtags = function (searchtags) {
            if (searchtags) {
                var flag = true;
                var length = $('#divsearchtags span').length;
                if (length > 9) {
                    $.fn_alert(true, true, "<?= $this->language('l_addticket1') ?>");
                    return false;
                }
//             $('#divsearchtags span').each(function(){
//                 if(searchtags == $(this).attr('data-tag')){
//                     flag = false;
//                     return false;
//                 }
//             });    
                if (flag == true) {
                    //alert(flag);
                    //var newtag = '<span data-tag="'+searchtags+'"">'+searchtags+'<a class="delsearchtags" data-key="'+length+'">X</a></span>';
                    $.fn_ajax('addsearchtags', {'searchtags': searchtags}, function (result) {
                        if (result.flag == false) {
                            $.fn_alert(true, true, "<?= $this->language('l_addticket1') ?>");
                        } else {
                            $('#divsearchtags').html(result.data);
                            $('#addsearchtags').val('');
                        }

                    }, false, false);
                }
            }
        }
        // Xóa search tags
        $('#divsearchtags').on('click', 'a.delsearchtags', function () { 
            localStorage.setItem("flagChange", "1");
            var key = $(this).attr('data-key');
            if (key) {
                $(this).closest('span').remove();
                $.fn_ajax('delsearchtags', {'key': key}, null, false, false);
            }
        });
        //
        
        $( ".changeTypeProduct" ).change(function() {
            //var tbridgetype2=$(this).text();
            var channel_id = document.getElementById('idChannel').value 
            changeChannel(channel_id);
            flagChanges();
            if( $.trim( $('#divsalechannel').html() ).length ) {
        		$.fn_confirm(true, {'class':"viewmanageproduct"},  "상품유형 변경시 판매채널 카테고리는 재 설정 하셔야 합니다. 상품유형을 수정하시겠습니까?");
        		$($.elt_popup).find('.back').val("취소");
        		$($.elt_popup).find('.continue').val("수정하기");
        		$($.elt_popup).on('click', '.confirm .viewmanageproduct .continue', function(){		
        			document.getElementById("divsalechannel").innerHTML='';
        			document.getElementById("divwarnsalechannel").innerHTML='';
        			$($.elt_popup).hide().find('.absolute').hide();
        		});
            }
    	});
        $( "#useStartedAt" ).bind("change paste keyup", function() {
        	flagChanges();
        });
        $( "#useEndedAt" ).bind("change paste keyup", function() {
        	flagChanges();
        });
        $( "#saleStartedAt" ).bind("change paste keyup", function() {
        	flagChanges();
        });
        $( "#saleEndedAt" ).bind("change paste keyup", function() {
        	flagChanges();
        });
        $('.delTypeChannel').click(function() {
        	$(this).parent().remove();
        });
    });

    function saveTemp(step) {
        var ff = document.nf;
        document.getElementById("step").value = step;
        //ff.submit();
    }


    function notlimit(source) {
        if (source.checked){
        	$("#useEndedAt").val("9999-12-31").trigger('change');
        	document.getElementById("useEndedAt").setAttribute("disabled", "disabled");
        }
        else {
            var today = new Date().toISOString().slice(0, 10)
            $("#useEndedAt").val(today).trigger('change');
            document.getElementById("useEndedAt").removeAttribute("disabled"); 
        }
    }
    

    $(document).ready(function () {
    	<?php if($noedit==0) {?>
        new JsDatePick({
            useMode: 2,
            target: "saleStartedAt",
            dateFormat: "%Y-%m-%d"
        });
        new JsDatePick({
            useMode: 2,
            target: "saleEndedAt",
            dateFormat: "%Y-%m-%d"
        });
        new JsDatePick({
            useMode: 2,
            target: "useStartedAt",
            dateFormat: "%Y-%m-%d"
        });
        new JsDatePick({
            useMode: 2,
            target: "useEndedAt",
            dateFormat: "%Y-%m-%d"
        });
        <?php }?>
    });
    // Chuyển hướng khi lưu thành công
    setTimeout(function () {
        var urlstep = $('#locationurlstep').attr('data-urlstep');
        if (urlstep) {
            $.fn_alert(true, true, "임시저장 되었습니다.");
        }
    }, 500);
</script>

<div class="ct_head" id="locationurlstep" data-urlstep="<?=$this->getData('urlstep') ?>" data-step="1">
    <?php
    require PATH_INCLUDES . 'top.php'; 
    ?>
</div>
<div class="ct_content">

    <div class="forminput">
        <form name="nf" id="nf" method="POST" action="<?= $this->route('editticket1') ?>/<?= $sellerProductId ?>" > 
            <div class="form_group clearfix frrow">

                <h3><?= $this->language('l_infoproduct') ?></h3>
                <div class="row rmclass" data-action="viewperson" data-perid="14">

                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><?= $this->language('l_codeproduct') ?></h3> 
                        </div>
                        <div class="form_item col-xs-3">
                            <input type="text" name="sellerProductId" id="sellerProductId" value="<?= $sellerProductId ?>" readonly="readonly" class="input full" autocomplete="off">
                            <input name="btnSumit" id="btnSumit" type="hidden" value="editticket1"/>
                        </div>
                        <div class="form_item col-xs-7 align-left"></div>
                    </div>

                    <div class="form_group clearfix" style="display: none;">
                        <div class="form_item col-xs-2">
                            <h3><?= $this->language('l_channelsell') ?></h3>
                            <input type="checkbox" onclick="checkAllchannel(this)"   value="all" id="checkall"/>
                            <label for="checkall"><?= $this->language('l_all') ?></label>
                        </div>
                        <div class="form_item col-xs-10" style="text-align: left;">
                            <?php
                            $i = 0;
                            foreach ($list_channel as $value => $giatri) {
                                $i++;
                                ?>
                                <div class="divBtn"
                                     style="width: 130px; margin: 2px;display: inline-block;">
                                    <input type="checkbox" name="checkchannel[]" value="<?= $giatri['channel_id'] ?>" id="checkchannel<?= $i ?>" onclick="checkchannel(this)"
                                        <?php
                                        if ($giatri['channelId'] != 0) {
                                            echo 'checked="checked"';
                                        }
                                        ?> />
                                    <label for="checkchannel<?= $i ?>"> <?= $giatri['channel_name'] ?></label>
                                </div>
                                <?php
                            }
                            ?>
                        </div>
                    </div>
                    
                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><span class="spanred">*</span>상품유형</h3>
                        </div>
                        <div class="form_item col-xs-1" style="width: 140px;">
                            <select class="select small full"   id="type1Ids" name="type1Ids">
                            	<?php  foreach ($tbridgetype1 as $value => $giatri) { ?>
                           		<option value="<?=$value?>" <?php if($idType1==$value) echo 'selected="selected"'; elseif($noedit==1) echo 'disabled="disabled"';?> ><?=$giatri?></option>
                           		<?php }?>
                            </select>
                        </div>
                        <div class="form_item col-xs-1" style="width: 140px;">
                            <select class="select small full changeTypeProduct"  id="type2Ids" name="type2Ids">
                            	<?php  foreach ($tbridgetype2[$idType1] as $value => $giatri) { ?>
                           		<option value="<?=$value?>" <?php if($idType2==$value) echo 'selected="selected"'; elseif($noedit==1) echo 'disabled="disabled"';?> ><?=$giatri?></option>
                           		<?php  } ?>
                           </select>
                        </div>
                        <div class="form_item col-xs-8"></div>
                    </div>
                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><span class="spanred">*</span><?= $this->language('l_type') ?></h3>
                        </div>
                        
                        <div class="form_item col-xs-1" id="ochannel" style="width: 140px;">
                            <select class="select small full" class="TextBoxField" id="idChannel" onchange="changeChannel(this.value)">
                               	<?php
                                    $i = 0;
                                    foreach ($list_channel as $value => $giatri) {
                                        $i++;
                                ?>
                                    <option value="<?= $giatri["channel_id"] ?>" ><?= $giatri["channel_name"] ?></option>
                                <?php } ?>
                            </select>
                            
                            <div style="text-align: left;width: 700px;padding-top: 5px;" id="divsalechannel">
                                <?= $this->getData('onloadsalechannel') ?>
                            </div>
                            <div style="text-align: left;width: 700px;padding-top: 5px;" id="divwarnsalechannel">
                            <?php 
                                if($this->getData('onloadsalechannel')!="")
           						echo '<p># 판매채널별 수수료율은 상품카테고리에 따라 다르며, 변경될 수 있습니다.</p>';
           						?>
           					</div>
                        </div>
                        
                        <div class="form_item col-xs-1" id="otype1" style="width: 140px;">
                            <select class="select small full" class="TextBoxField" onchange="changeType1(this.value)" id="type1Id" name="type1Id">
                            <?php
                                $i = 0;$type_depth1="";
                                foreach ($type_depth as $value => $giatri) {
                                    if ($i == 0)
                                        $type_depth1 = $value;
                                    $i++;
                            ?>
                           		<option value="<?=$value?>" <?php if( $type_depth1 == $value) echo 'selected="selected"';?> ><?=$value?></option>
                            <?php
                                }
                            ?>
                            </select>
                        </div>
                        <div class="form_item col-xs-1" id="otype2" style="width: 140px;">
                            <select class="select small full" class="TextBoxField" onchange="changeType2(this.value)" id="type2Id" name="type2Id">
                            <?php
                                $i = 0;$type_depth2="";
                                foreach ($type_depth[$type_depth1] as $value => $giatri) {
                                    if ($i == 0)
                                        $type_depth2 = $value;
                                    $i++;
                           ?>
                           		<option value="<?=$value?>"  <?php if( $type_depth2 == $value) echo 'selected="selected"';?>  ><?=$value?></option>
                           <?php
                                }
                           ?>
                           </select>
                        </div>
                        <div class="form_item col-xs-1" id="otype3" style="width: 140px;">
                            <select class="select small full" class="TextBoxField" onchange="changeType3(this.value)" id="type3Id" name="type3Id" >
                            <?php
                                $i = 0;$type_depth3="";
                                foreach ($type_depth[$type_depth1][$type_depth2] as $value => $giatri) {
                                    if ($i == 0)
                                        $type_depth3 = $value;
                                    $i++;
                           ?>
                           		<option value="<?=$value?>"  <?php if( $type_depth3 == $value) echo 'selected="selected"';?>  ><?=$value?></option>
                           <?php
                                }
                           ?>
                            </select>
                        </div>
                        <div class="form_item col-xs-1" id="otype4" style="width: 140px;">
                            <select class="select small full" class="TextBoxField" id="type4Id" name="type4Id">
                            <?php
                                $i = 0;$type_depth4="";
                                foreach ($type_depth[$type_depth1][$type_depth2][$type_depth3] as $value => $giatri) {
                                    if ($i == 0)
                                        $type_depth4= $value;
                                    $i++;
                           ?>
                           		<option value="<?=$value?>"  <?php if( $type_depth4 == $value) echo 'selected="selected"';?>  ><?=$value?></option>
                           <?php
                                }
                           ?>
                            </select>
                        </div>
                        <div class="form_item col-xs-1" style="padding-top: 2px;width: 70px;">
                            <input type="button" class="btn hover small addsalechannel" onclick="addsalechannel()" value="등록">
                        </div>
                    </div>

                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><span class="spanred">*</span><?= $this->language('l_regional_category') ?></h3>
                        </div>
                        <div class="form_item col-xs-2">
                            <select class="select small full" class="TextBoxField" name="cityId"
                                    onchange="changecity(this.value)">
                                <?php
                                $id_city = $travelTypeId;
                                foreach ($list_city as $value => $giatri) {
                                    ?>
                                    <option value="<?= $giatri['id'] ?>" <?php if ($id_city == $giatri["id"]) {
                                        echo 'selected="selected"';
                                    } ?>><?= $giatri["name"] ?></option>
                                    <?php
                                }
                                ?>
                            </select>
                        </div>

                        <div class="form_item col-xs-2" id="district">
                            <select class="select small full" class="TextBoxField" name="districtId"
                                    onchange="changedistrict(this.value)" id="districtId">
                                <?php
                                $id_district = $productDetailTypeId;
                                foreach ($list_district as $value => $giatri) {
                                    if ($giatri['id_city'] == $id_city) {
                                        $i++;
                                        ?>
                                        <option value="<?= $giatri['id'] ?>" <?php if ($id_district == $giatri["id"]) {
                                            echo 'selected="selected"';
                                        } ?>><?= $giatri['name'] ?></option>
                                        <?php
                                    }
                                }
                                ?>
                            </select>
                        </div>
                        <div class="form_item col-xs-2" id="ward">
                            <?php
                            $dem = 0;
                            foreach ($list_ward as $value => $giatri) {
                                if ($giatri["id_district"] == $id_district) {
                                    $dem++;
                                }
                            }
                            if ($dem > 0) {
                                ?>
                                <select class="select small full" class="TextBoxField" name="wardId" onchange="flagChanges();" >
                                    <?php
                                    $id_ward = 0;
                                    foreach ($list_ward as $value => $giatri) {
                                        if ($giatri['id_district'] == $id_district) {
                                            $i++;
                                            ?>
                                            <option value="<?= $giatri['id'] ?>" <?php if ($id_ward == $giatri["id"]) {
                                                echo 'selected="selected"';
                                            } ?>> <?= $giatri['name'] ?></option>
                                            <?php
                                        }
                                    }

                                    ?>
                                </select>
                                <?php
                            }
                            ?>
                        </div>
                        <div class="form_item col-xs-4 align-left"></div>
                    </div>

                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><span class="spanred">*</span><?= $this->language('l_nameproduct') ?></h3>
                        </div>
                        <div class="form_item col-xs-6">
                            <input name="name" maxlength="50" id="name" onchange="flagChanges();" type="text" value="<?= $name ?>" data-text="<?=$this->language('l_warnname')?>" class="input full checkMaxLength" />
                        </div>
                        <div class="form_item col-xs-4 align-left">
                            <p class="height1 checkMaxLengthView" onchange="flagChanges();"><?= strlen($name) ?>/50 <?= $this->language('l_warnname') ?></p>
                        </div>
                    </div>

                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><span class="spanred">*</span><?= $this->language('l_tagsproduct') ?></h3>
                        </div>
                        <div class="form_item col-xs-6">
                            <input id="addsearchtags" type="text" value=""   placeholder="<?= $this->language('l_warntagsproduct') ?>"  class="input full"/>
                            <div class="contBox" id="divsearchtags"
                                 style="padding: 10px 0px 5px 10px; text-align: left; min-width: 700px;"><?= $this->getData('onloadsearchtags') ?></div>
                        </div>
                        <div class="form_item col-xs-1" style="padding-top: 3px;">
                            <input type="button" class="btn hover small addsearchtags" value="등록">
                        </div>
                        <div class="form_item col-xs-3 align-left"></div>
                    </div>

                    <div class="form_group clearfix" style="display: none;">
                        <div class="form_item col-xs-2">
                            <h3><?= $this->language('l_displayKeyword') ?></h3>
                        </div>
                        <div class="form_item col-xs-6">
                            <input name="displayKeyword" maxlength="70" id="displayKeyword" type="text"
                                   value="<?= $displayKeyword ?>" class="input full"
                                   placeholder="<?= $this->language('l_warndisplayKeyword') ?>"/>
                        </div>
                        <div class="form_item col-xs-4 align-left"></div>
                    </div>

                    <div class="form_group clearfix" style="display: none;">
                        <div class="form_item col-xs-2">
                            <h3><?= $this->language('l_displayCategoryCode') ?></h3>
                        </div>
                        <div class="form_item col-xs-6">
                            <input name="displayCategoryCode" maxlength="70" id="displayCategoryCode" type="text"
                                   value="<?= $displayCategoryCode ?>" class="input full"
                                   placeholder="<?= $this->language('l_warndisplayCategoryCode') ?>"/>
                        </div>

                        <div class="form_item col-xs-4 align-left"></div>
                    </div>

                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><?= $this->language('l_pricerepresentative') ?></h3>
                        </div>
                        <div class="form_item col-xs-7" id="divpricerepresentative"
                             style="text-align: left; padding-top: 10px;"><?= number_format($pricerepresentative) ?></div>
                        <div class="form_item col-xs-3 align-left">
                            <!-- <input name="pricerepresentative" id="pricerepresentative" type="hidden" value="0" /> -->
                        </div>
                    </div>

                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><?= $this->language('l_pricebasic') ?></h3>
                        </div>
                        <div class="form_item col-xs-7" id="divpricebasic"
                             style="text-align: left; padding-top: 10px;"><?= number_format($pricebasic) ?></div>
                        <div class="form_item col-xs-3 align-left">
                            <!-- <input name="pricebasic" id="pricebasic" type="hidden" value="0" /> -->
                        </div>
                    </div>
                </div>

                <h3><?= $this->language('l_conditionsell') ?></h3>
                <div class="row rmclass" data-action="viewperson" data-perid="14">
                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><span class="spanred">*</span><?= $this->language('l_timesell') ?></h3>
                        </div>
                        <div class="form_item col-xs-2">
                            <input name="useStartedAt" id="useStartedAt" type="text" value="<?= $useStartedAt ?>" class="input full" readonly="readonly"/>
                        </div>
                        <div class="form_item col-xs-2">
                            <input name="useEndedAt" id="useEndedAt" type="text" value="<?= $useEndedAt ?>" class="input full" readonly="readonly"/>
                        </div>
                        <div class="form_item col-xs-2" style="padding-top: 5px;text-align: left;">
                            <input type="checkbox" onchange="flagChanges();" onclick="notlimit(this)" name="checknotlimit" id="checknotlimit" <?php if ($nolimittime == 1) echo 'checked="checked"'; if($noedit==1) echo 'disabled="disabled"';?> />
                            <label for="checknotlimit"><?= $this->language('l_nolimittime') ?></label>
                        </div>
                        <div class="form_item col-xs-4 align-left"></div>
                    </div>

                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2">
                            <h3><?= $this->language('l_timeperiod') ?></h3>
                        </div>
                        <div class="form_item col-xs-2">
                            <input name="saleStartedAt" onchange="flagChanges();" id="saleStartedAt" type="text" value="<?= $saleStartedAt ?>" class="input full" readonly="readonly"/>
                        </div>
                        <div class="form_item col-xs-2">
                            <input name="saleEndedAt" onchange="flagChanges();" id="saleEndedAt" type="text" value="<?= $saleEndedAt ?>" class="input full" readonly="readonly"/>
                        </div>

                        <div class="form_item col-xs-6 align-left"></div>
                    </div>

                    <!-- <div class="form_group clearfix">
                        <div class="form_item col-xs-2 height3">
                            <h3>체크리스트 발송 </h3>
                        </div>
                        <div class="form_item col-xs-6">
                            <input name="email1" id="email1" onchange="flagChanges();" type="text" value="<?= $email[1] ?>" class="input full"
                                   placeholder="<?= $this->language('l_inputemail') ?>"/>
                            <input name="email2" id="email2" onchange="flagChanges();" type="text" value="<?= $email[2] ?>" class="input full"
                                   placeholder="<?= $this->language('l_inputemail') ?>"/>
                            <input name="email3" id="email3" onchange="flagChanges();" type="text" value="<?= $email[3] ?>" class="input full"
                                   placeholder="<?= $this->language('l_inputemail') ?>"/>
                        </div>
                        <div class="form_item col-xs-4 align-left"></div>
                    </div> -->

                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2 ">
                            <h3><?= $this->language('l_supplier') ?></h3>
                        </div>
                        <div class="form_item col-xs-2">
                            <select name="supplier" onchange="flagChanges();" id="supplier" class="select small full">
                                <?php foreach ($list_supplier as $value => $giatri) { ?>
                                <option <?php if ($supplier == $giatri['idx']) echo 'selected="selected"'; elseif($noedit==1) echo 'disabled="disabled"';?> 
                                		value="<?= $giatri['idx'] ?>"><?= $giatri['ID'] ?></option>
                                <?php } ?>

                            </select>
                        </div>
                        <div class="form_item col-xs-8 align-left"></div>
                    </div>
                    <div class="form_group clearfix">
                        <div class="form_item col-xs-2 ">
                            <h3><?= $this->language('l_settlement') ?></h3>
                        </div>
                        <div class="form_item col-xs-2" style="min-width: 160px;margin-top: 8px;text-align: left;">
                            <input type="radio" onchange="flagChanges();" name="settlement" value="0" <?php if ($settlement == 0) echo 'checked="checked"';  elseif($noedit==1) echo 'disabled="disabled"';?> id="checksettlement0"/>
                            <label for="checksettlement0">판매가 기준정산</label>
                        </div>
                        <div class="form_item col-xs-2" style="min-width: 160px;margin-top: 8px;text-align: left;">
                            <input type="radio" onchange="flagChanges();" name="settlement" value="1" <?php if ($settlement == 1) echo 'checked="checked"';  elseif($noedit==1) echo 'disabled="disabled"';?> id="checksettlement1">
                            <label for="checksettlement1">입금가(공급가) 기준정산 </label>

                        </div>
                        <div class="form_item col-xs-6 align-left"></div>
                    </div>

                </div>

                <div class="table_content">
                    <table class="table" style="float: right;">
                        <tr>
                            <td colspan="8">
                                <input type="hidden" name="step" id="step" value="1">
                                <div class="btnupload">
                                    <button type="button"  style="width: 100px; float: right;" class="btn hover"
                                            id="continuelink" data-step="2"><?= $this->language('l_continue') ?></button> 
                                    <button type="button" style="width: 100px; float: right;margin-right: 5px"
                                            class="btn hover" id="saveTemp" data-step="1"><?= $this->language('l_savedraft') ?></button>
                                </div>
                            </td>

                        </tr>
                    </table>
                </div>
            </div>
        </form>

    </div>
</div>