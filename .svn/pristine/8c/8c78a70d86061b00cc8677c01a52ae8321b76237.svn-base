$(document).ready(function(){ 
    function getMessage(){
        if ($('#navbarDropdown>img').length) {
            var flag = $('#navbarDropdown>img').attr('src');
            var pos =flag.lastIndexOf( flag.charAt( flag.indexOf(":")+1) );
            var flagname = flag.substring( pos+1);
            flagname = flagname.split('.')[0].toLowerCase(); 
            if (flagname == 'en') {
                return  {
                    name: "Please enter your name",
                    email: "Please enter a valid email address",
                    point: "Please enter numberic and numberic > 0",
                }
            }
            if (flagname == 'vn') {
                return {
                    name: "Vui lòng nhập tên của bạn",
                    email: "Vui lòng nhập một địa chỉ email hợp lệ",
                    point: "Vui lòng nhập số và số lớn hơn 0",
                }
            }
            if (flagname == 'kr') {
                return {
                    name: "이름을 입력하세요",
                    email: "유효한 이메일 주소를 입력하십시오",
                    point: "0보다 큰 숫자와 숫자를 입력하세요",
                }
            }
            return {
                name: "Please enter your name",
                email: "Please enter a valid email address",
                point: "Please enter numberic and numberic > 0",
            }
        }
        return {
            name: "Please enter your name",
            email: "Please enter a valid email address",
            point: "Please enter numberic and numberic > 0",
        }
        
    }
   
  

    $('#btnRegister').on('click', function() {
        if(!$("#registerForm").valid()) return false;
        var userName = $("#userName").val();
        var phone = $("#phone").val();
        var point = $("#point").val();
        if(point =='') point = 0;

        var url = $baseUrl + '/registerUser.html'; 
        $.blockUI({
                message: '<h1><img src="' + $baseUrl + '/public/img/busy.gif" /></h1>',
                baseZ: 999999,
                css: {
                    paddingBottom: '15px',
                }
            });

        $.ajax({
            url: url,
            type: 'POST',
            data: {
                name:userName,
                phone:phone,
                point:point
            },
            dataType:'text',
            success:function(data){             
                jsonData =  $.parseJSON(data);
                if(jsonData.status == false){
                    $("#msg_err_home").html(jsonData.msg);
                    $.unblockUI();                                        
                    return false;
                } else {
                    document.getElementById("userName").value="";
                    document.getElementById("phone").value="";
                    document.getElementById("point").value="";
                    $("#msg_err_home").html(jsonData.msg);
                    $("#totalUser").html(jsonData.total);
                    $('.tv_rows:first-child').before(jsonData.adduser);
                    $('.keyboard').css("display","none");
                    $.unblockUI(); 
                    $("#msg_err_home").html(jsonData.msg);                                      
                    setTimeout(function() { $('#dangkytvModal').modal('hide'); }, 2000);
                }
            }
        });
    });
    $('#btnRegister_close').on('click', function() {        
        $('.keyboard_register').addClass('keyboard--hidden_register');
        $('#dangkytvModal').modal('hide');
    });
    
    $('#btnRegistersetting').on('click', function() {
        if(!$("#registerFormsetting").valid()) return false;
        var userName = $("#userNamesetting").val();
        var email = $("#emailsetting").val();
        var point = $("#pointsetting").val();
        if(point =='') point = 0;
        var url = $baseUrl + '/registersettingUser.html'; 
        $.blockUI({
	        message: '<h1><img src="' + $baseUrl + '/public/img/busy.gif" /></h1>',
	        baseZ: 999999,
	        css: {
	            paddingBottom: '15px',
	        }
	    });

        $.ajax({
            url: url,
            type: 'POST',
            data: {
                name:userName,
                email:email,
                point:point
            },
            dataType:'text',
            success:function(data){            	
                jsonData =  $.parseJSON(data);
                if(jsonData.status == false){
                    $("#msg_err").html(jsonData.msg);
                    $.unblockUI();                                        
                    return false;
                } else {
                    document.getElementById("userNamesetting").value="";
                    document.getElementById("emailsetting").value="";
                    document.getElementById("pointsetting").value=""; 
                    $("#msg_err").html(jsonData.msg);
                    $(".number_clb").html(jsonData.total);
                    $('.tv_rows:first-child').before(jsonData.adduser);
                    $('.keyboard').css("display","none");
                    $.unblockUI();                                       
                    setTimeout(function() { $('#registersettingModal').modal('hide'); }, 2000);
                }
            }
        });

    });
    $('#btnRegistersetting_close').on('click', function() {
        $('.keyboard_registersetting').addClass('keyboard--hidden_registersetting');
        $('#registersettingModal').modal('hide');
    });
    $('#btnRegisterlistmember').on('click', function() {
        if(!$("#registerFormlistmember").valid()) return false;
        var userName = $("#userNamelistmember").val();
        var phone = $("#phonelistmember").val();
        var point = $("#pointlistmember").val();
        if(point =='') point = 0;
        var url = $baseUrl + '/registerlistmemberUser.html'; 
        $.blockUI({
	        message: '<h1><img src="' + $baseUrl + '/public/img/busy.gif" /></h1>',
	        baseZ: 999999,
	        css: {
	            paddingBottom: '15px',
	        }
	    });

        $.ajax({
            url: url,
            type: 'POST',
            data: {
                name:userName,
                phone:phone,
                point:point
            },
            dataType:'text',
            success:function(data){            	
                jsonData =  $.parseJSON(data);
                if(jsonData.status == false){                    
                    $("#msg_err_listmember").html(jsonData.msg);
                    $.unblockUI();                                        
                    return false;
                } else {
                    document.getElementById("userNamelistmember").value="";
                    document.getElementById("phonelistmember").value="";
                    document.getElementById("pointlistmember").value="";                
                    $("#msg_err_listmember").html(jsonData.msg);
                    $("#totalUser").html(jsonData.total);
                    $('.tv_rows:first-child').before(jsonData.adduser);
                    //$(".show").removeClass("show");
                    //$('.keyboard_register_listmember').addClass('keyboard--hidden_register_listmember');
                    $.unblockUI();                                       
                    setTimeout(function() { $('#dangkytvModal_ds').modal('hide'); }, 2000);
                }
            }
        });

    });
    $('#btnRegisterlistmember_close').on('click', function() {
        $('.keyboard_register_listmember').addClass('keyboard--hidden_register_listmember');
        $('#dangkytvModal_ds').modal('hide');
    });

    

    $("#registerForm").validate({
    	rules: {
    		name: {
                required: true,
                normalizer: function( value ) {
                    return $.trim( value );
                  }
            },
    		phone:{
                        required: true,
                },
                point:{
                        required: true,
                        number: true,
                        min: 1
                }
    	},
            messages: getMessage()
    })
    $("#registerFormsetting").validate({
    	rules: {
    		name: {
                required: true,
                normalizer: function( value ) {
                    return $.trim( value );
                  }
            },
    		email: {
                        required: true,
                        email: true
                },
                point:{
                    required: true,
                        number: true,
                        min: 1
                }
    	},
            messages: getMessage()
    })
    
    $("#registerFormlistmember").validate({
    	rules: {
    		name: {
                required: true,
                normalizer: function( value ) {
                    return $.trim( value );
                  }
            },
    		phone: {
                        required: true
                },
                point:{
                    required: true,
                        number: true,
                        min: 1
                }
    	},
            messages: getMessage()
    })
})