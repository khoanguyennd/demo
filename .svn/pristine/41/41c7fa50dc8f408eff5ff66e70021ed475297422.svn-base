<?php
    $trandau_id=$this->_params['trandau_id'];
    $trandau = $this->getData('trandau');
    $trandau_thanhvien = $this->getData('trandau_thanhvien');
    $thanhvien1 = $this->getData('thanhvien1');
    $thanhvien2 = $this->getData('thanhvien2');
    
    foreach ($trandau_thanhvien as $key=>$value){
        if($thanhvien1['id']==$value['thanhvien_id']){
            $diem_ketthuc_player1=$value['diem'];
        }
        if($thanhvien2['id']==$value['thanhvien_id']){
            $diem_ketthuc_player2=$value['diem'];
        }
    }

    $infoInnering = $this->getData('innering');
    $innering = $infoInnering['innering'];
    $currentUser = $infoInnering['user_current'] ? $infoInnering['user_current'] : 0;
    $totalTime = $this->getData('totalTime') > 0 ? $this->getData('totalTime') : 0;
    
    $currentPointUser1 = $this->getData('currentPointUser1');
    $currentPointUser2 = $this->getData('currentPointUser2');
    
    // bảng lịch sử lượt đánh
    $historyPointUser1 = $this->getData('historyPointUser1');
    $historyPointUser2 = $this->getData('historyPointUser2');
    
    $hour = 0;
    if($totalTime >= 3600) $hour = round($totalTime/ (60*60));
    $secondRemain = $totalTime - $hour * (60*60);
    $minutes = round($secondRemain/60);
    $statisticalUser = $this->getData('statisticalUser');    
?>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"/>
<script>
    acecptComeBack();         
    var music = new Audio("<?= URL_BASE ?>/public/sound/start_" + lang +  ".mp3");
    music.play();
    $(document).ready(function () {                    
        $(".cbutton").click(function () {
            var strDiv1Content = document.getElementById('start_player1').innerHTML;
            var strDiv2Content = document.getElementById('start_player2').innerHTML;
            strDiv1Content.replace('start_player_diem_span1', 'start_player_diem_span2');
            strDiv2Content.replace('start_player_diem_span2', 'start_player_diem_span1');
            document.getElementById('start_player1').innerHTML = strDiv2Content;
            document.getElementById('start_player2').innerHTML = strDiv1Content;
            const element = document.querySelector('#start_player1');
            element.classList.add('animate__animated', 'animate__fadeInLeft');
            element.addEventListener('animationend', () => {
                element.classList.remove('animate__animated', 'animate__fadeInLeft');
            });
            const element2 = document.querySelector('#start_player2');
            element2.classList.add('animate__animated', 'animate__fadeInRight');
            element2.addEventListener('animationend', () => {
                element2.classList.remove('animate__animated', 'animate__fadeInRight');
            });

            var status_sound = document.getElementById("status_sound").value;      
            if(status_sound==1){
                var music = new Audio("<?= URL_BASE ?>/public/sound/changepos.mp3");
                music.play();
            }
            var user1 = $('#user1').val();
            var user2 = $('#user2').val();
            if($('#point_inning' + user2).hasClass('pointInningRight')){
                $('#point_inning' + user2).removeClass('pointInningRight');
                $('#point_inning' + user2).addClass('pointInningLeft');
            } else {
                $('#point_inning' + user2).removeClass('pointInningLeft')
                $('#point_inning' + user2).addClass('pointInningRight')
            }
            
            if($('#point_inning' + user1).hasClass('pointInningRight')){
                $('#point_inning' + user1).removeClass('pointInningRight');
                $('#point_inning' + user1).addClass('pointInningLeft');
            } else {
                $('#point_inning' + user1).removeClass('pointInningLeft')
                $('#point_inning' + user1).addClass('pointInningRight')
            }

            if($('#timeCurrentUser' + user2).hasClass('start_player_diem_span2')){
                $('#timeCurrentUser' + user2).removeClass('start_player_diem_span2');
                $('#timeCurrentUser' + user2).addClass('start_player_diem_span1');
            } else {
                $('#timeCurrentUser' + user2).removeClass('start_player_diem_span1')
                $('#timeCurrentUser' + user2).addClass('start_player_diem_span2')
            }
            
            if($('#timeCurrentUser' + user1).hasClass('start_player_diem_span1')){
                $('#timeCurrentUser' + user1).removeClass('start_player_diem_span1');
                $('#timeCurrentUser' + user1).addClass('start_player_diem_span2');
            } else {
                $('#timeCurrentUser' + user1).removeClass('start_player_diem_span2')
                $('#timeCurrentUser' + user1).addClass('start_player_diem_span1')
            }
        });        
    });        
</script>
<script type="text/javascript">
    $( document ).ready(function() {
        var userActiveTrandau = <?=$trandau['khaicuoc_user']?>;
        var user1 = <?=$thanhvien1['id']?>;
        var user2 = <?=$thanhvien2['id']?>;
        if(userActiveTrandau == user1)
        {
            var otherUser = user2;
        } else {
            var otherUser = user1;
        }
        $('.resettime').hide();
        <?php if($currentUser ==1){?>        
        $('.button2point' + userActiveTrandau).show();
        $('#textPoint' + userActiveTrandau).hide();
        $('#timeCurrentUser' + userActiveTrandau).show();
        $('#main_point' + userActiveTrandau).addClass('background_player_active');
        $('#circle_point' + userActiveTrandau).attr('data-id', userActiveTrandau);

        $('.button2point' + otherUser).hide();
        $('#textPoint' + otherUser).show();
        $('#timeCurrentUser' + otherUser).hide() 
        $('#main_point' + otherUser).removeClass('background_player_active');  
        $('#circle_point' + otherUser).attr('data-id', userActiveTrandau);       
        <?php }?>

        <?php if(!$currentUser){?>
            $('.button2point' + userActiveTrandau).hide();
            $('#textPoint' + userActiveTrandau).show();
            $('#timeCurrentUser' + userActiveTrandau).hide();
            $('#main_point' + userActiveTrandau).removeClass('background_player_active');
            $('#circle_point' + userActiveTrandau).attr('data-id', otherUser);

            $('.button2point' + otherUser).show();
            $('#textPoint' + otherUser).hide();
            $('#timeCurrentUser' + otherUser).show()  
            $('#main_point' + otherUser).addClass('background_player_active');
            $('#circle_point' + otherUser).attr('data-id', otherUser);       
        <?php }?>
        
        start();
        timedCountCurrentUser(); 
    });
</script>
<style type="text/css">
    .row {margin: 0px;}
    .start_mobi_2_user{display: flex;}
    .row_thongke_detail{padding-left: 0px;padding-right: 0px;text-align: center;}
    .imagesload_wait_button_change_turn{ width: 80px;position: absolute;left: 43px;top: -7px;height: auto;}
    .imagesload_wait_button_cancel{ width: 80px;position: absolute;left: 43px;top: -7px;height: auto;}
    .start_mobi_container{line-height:1.5;padding: 5px 5px 0px 5px;}
    .title_history_mobi{padding: 6px 0px; background: #000d40};
    .title_history_mobi p{margin-bottom: 0px; font-size: 12px;}
    .background_player_active{background-color: #adc6da;}
    .star-player-main {padding: 2px; position: relative;}

    .div_tow_button{width:50%; float: left;}
    .div_button_tranfer{padding-right:2px;text-align: center; position: relative;}
    .imagesload_wait_button_change_turn{ width: 116px;position: absolute;left: 190px;top: 7px;height: 60px; }

    .div_button_cancel{padding-left:2px;text-align: center; position: relative;}
    .imagesload_wait_button_cancel{ width: 116px;position: absolute;left: 190px;top: 7px;height: 60px; }
    #divsound img {margin-top: -10px;width: 35px;padding-left: 10px;}        
    p{margin-bottom: 0px}
    .start_player_diem_sm  {
        border-radius: 50%;text-align: center;font-size: 90px;font-weight: bold;color: #000000;width: 130px;margin: 0 auto;vertical-align: middle;
        font-family: utm avo !important;text-shadow: rgb(0,0,0, 0.6) 0px 0px 0px;position: relative;display: table;
    }
    .start_player_diem_color-bl {background: linear-gradient(180deg, #fff510 0%, #383415 100%);}
    .start_player_diem_color-or {background: linear-gradient(180deg, #ffffff 0%, #46565d 100%);}
    span.start_player_diem_span2 {
        position: absolute;top: 0px;right: 0px;font-size: 14px;background: #272730; opacity: 0.8;padding: 5px 7px;
        border-radius: 50%;box-shadow: rgb(0,0,0, 0.3) 2px 2px 2px;text-shadow: rgb(0,0,0, 0.3) 2px 2px 2px;border:#f69929 1px solid; color: #f69929;
    }
            
    span.start_player_diem_span1 {
        position: absolute;
        top: 0px;
        left: 0px;
        font-size: 14px;
        background: #272730;
        opacity: 0.8;
        padding: 5px 7px;
        border-radius: 50%;
        box-shadow: rgb(0,0,0, 0.3) 2px 2px 2px;
        text-shadow: rgb(0,0,0, 0.3) 2px 2px 2px;
        border: #f69929 1px solid;
        color: #f69929;
    }
    .pointInningLeft{left:0px;}
    .pointInningRight{right: 0px;}
    
    #conformStop a.btn-blue:active{
        color: #fff;
        background-color: #0069d9;
        border-color: #0062cc;
    }
    .start_mobi_container .time_now_system {
        font-size: 25px !important;
        background: #0261b1;
        border: #013181 1px solid;
        color: #ffffff;
        border-radius: 10px;
        text-align: center;
        font-family: digital-7 mono;
    }
    .start_mobi_container .time_system {
        font-size: 20px !important;
        background: #0261b1;
        border: #0261b1 1px solid;
        color: #ffffff;
        border-radius: 10px;
        text-align: center;
        font-family: digital-7 mono;
    }
    @media (min-width: 992px) and (max-width: 1200px){
        .name-item {line-height: 38px !important;font-size: 22px !important;}
        .star-player-main {padding: 20px;}
        .point_inning{ position: absolute; top: 0px; font-size: 30px; border-radius: 0%; background: #000d40; padding: 0px 5px; }
        .container-fluid{padding: 5px;}
        #conformStop .modal-dialog {max-width: 90%; margin-top: 5%}
        .start_mobi_container{max-width: 100% !important;}
        .start_mobi_container .item_col_player{width: 35%;}
        .start_mobi_container .item_col_main{width: 30%;padding-right:4px; padding-left: 4px}
        .start_mobi_container  button.btn-blue-n{padding: 14px 24px !important} 
        .start_mobi_container button.btn-blue-n .fa {font-size: 32px;}
        .start_mobi_container button.btn-blue-bn {padding: 8px 2px 8px 2px;font-size: 18px !important}
        .start_mobi_container button.tow_btn_row {line-height: 50px !important; font-size: 20px;}
        .start_mobi_container button.text-over-button{height: 60px; overflow: hidden; line-height: 20px !important;}
        .start_mobi_container .add_diemchodoithu {font-size: 20px}
        .start_player_button_start_mobi {margin-top: 25px !important;}
        .start_mobi_container .start_player_diem {
            border-radius: 50%;
            text-align: center;
            font-size: 150px;
            font-weight: bold;
            color: #000000;
            width: 240px;
            margin: 0 auto;
            vertical-align: middle;
            font-family: utm avo !important;
            text-shadow: rgb(0,0,0, 0.6) 0px 0px 0px;
            position: relative;
            display: table;
        }
        .start_mobi_container span.start_player_diem_span1 { top: 5px; left: 0px; font-size: 16px; padding: 8px 8px;}
        .start_mobi_container span.start_player_diem_span2 {top: 8px; right: 0px; font-size: 16px; padding: 5px 8px;}
        .start_mobi_container .main-bgt{background-color: rgba(0, 1, 51, 0.3); border: #056cc3 1px solid; border-radius: 10px; padding: 5px;}
        .start_mobi_container .time_march{
            font-size: 30px !important;
            background: #001d6c;
            border: #013181 1px solid;
            color: #f7941d;
            border-radius: 10px;
            text-align: center;
            font-family: digital-7 mono;
        }
        .start_mobi_container .time_system{font-size:32px !important;}
        .start_mobi_container .cl_luot { 
            text-transform: uppercase;
            font-size: 30px;
            color: #0179df;
            text-align: center;
            font-weight: 300;            
            position: relative;
            padding: 0px 0px 36px  0px;
        }
        .start_mobi_container .start_luot_content {font-size:100px !important;}
        .start_mobi_container .main_history_mobi{
            font-size: 13px;
            height: 100%;
            overflow-y: hidden;
            height: 45px;
            text-align: center;
        }
        .start_mobi_container .start_luot_button{ background: #000d40; padding: 0px; border-radius: 5px}
        .start_mobi_container .diem-chap-tv {
            width: 40%;
            float: left;
            font-size: 44px;
            color: #f7941d;
            text-transform: uppercase;
            text-align: center;
            text-shadow: rgb(0,0,0, 0.6) 2px 2px 1px;
            line-height: 44px;
        }
        .start_mobi_container .detail-tv{
            width: 60%;
            float: left;
            font-size: 15px;
            padding-left: 10px;
            text-transform: uppercase;
        }
        .start_player_history {background: #023685; text-align: center; text-transform: uppercase;font-size: 11px; border-radius: 0 0 8px 8px;}

        #conformStop .list-diem-a {
            background: linear-gradient(90deg, rgba(1,30,69,1) 0%, rgba(1,45,105,1) 35%, rgba(1,53,124,1) 100%);
            border: #1e93f6 0px solid;padding: 5px 15px;border-radius: 8px;float: left;margin-bottom: 8px ;width: 100%; line-height: 30px
        }
        .row_thongke_detail{font-size: 20px;}
        .title_history_mobi p{margin-bottom: 0px; font-size: 16px;}

    }
    @media (max-width: 992px) and (min-width: 768px){
        .point_inning{ position: absolute; top: 0px; font-size: 30px; border-radius: 0%; background: #000d40; padding: 0px 5px; }
        .container-fluid{padding: 5px;}
        #conformStop .modal-dialog {max-width: 90%; margin-top: 5%}
        .start_mobi_container{max-width: 100% !important;}
        .start_mobi_container .item_col_player{width: 35%;}
        .start_mobi_container .item_col_main{width: 30%;padding-right:4px; padding-left: 4px}
        .start_mobi_container  button.btn-blue-n{padding: 8px 20px !important} 
        .start_mobi_container button.btn-blue-n .fa {font-size: 20px;}
        .start_mobi_container button.btn-blue-bn {padding: 8px 2px 8px 2px;font-size: 18px}
        .start_mobi_container button.tow_btn_row {line-height: 40px !important; font-size: 18px;}
        .start_mobi_container button.text-over-button{height: 52px; overflow: hidden; line-height: 20px !important;}
        .start_mobi_container button.text-over-button-top{height: 60px; overflow: hidden; line-height: 20px !important;}     
        .start_mobi_container .add_diemchodoithu {font-size: 12px;margin-top: 3px;}
        .start_mobi_container .start_player_diem {
            border-radius: 50%;
            text-align: center;
            font-size: 102px;
            font-weight: bold;
            color: #000000;
            width: 165px;
            margin: 0 auto;
            vertical-align: middle;
            font-family: utm avo !important;
            text-shadow: rgb(0,0,0, 0.6) 0px 0px 0px;
            position: relative;
            display: table;
        }

        .start_mobi_container .main-bgt{background-color: rgba(0, 1, 51, 0.3); border: #056cc3 1px solid; border-radius: 10px; padding: 5px;}
        .start_mobi_container .time_march{
            font-size: 22px !important;
            background: #001d6c;
            border: #013181 1px solid;
            color: #f7941d;
            border-radius: 10px;
            text-align: center;
            font-family: digital-7 mono;
        }
        .start_mobi_container .cl_luot { 
            text-transform: uppercase;
            font-size: 14px;
            color: #0179df;
            text-align: center;
            font-weight: 300;            
            position: relative;
            padding: 0px 0px 17px  0px;
        }
        .start_mobi_container .start_luot_content {font-size:46px !important;}
        .start_mobi_container .main_history_mobi{
            font-size: 13px;
            height: 100%;
            overflow-y: hidden;
            height: 45px;
            text-align: center;
        }
        .start_mobi_container .start_luot_button{ background: #000d40; padding: 0px; border-radius: 5px}
        .start_mobi_container .diem-chap-tv {
            width: 40%;
            float: left;
            font-size: 38px;
            color: #f7941d;
            text-transform: uppercase;
            text-align: center;
            text-shadow: rgb(0,0,0, 0.6) 2px 2px 1px;
            line-height: 30px;
        }
        .start_mobi_container .detail-tv{
            width: 60%;
            float: left;
            font-size: 11px;
            padding-left: 10px;
            text-transform: uppercase;
        }
        .start_player_history {background: #023685; text-align: center; text-transform: uppercase;font-size: 11px; border-radius: 0 0 8px 8px;}

        #conformStop .list-diem-a {
            background: linear-gradient(90deg, rgba(1,30,69,1) 0%, rgba(1,45,105,1) 35%, rgba(1,53,124,1) 100%);
            border: #1e93f6 0px solid;padding: 5px 15px;border-radius: 8px;float: left;margin-bottom: 8px ;width: 100%; line-height: 30px
        }
    }
    @media (min-width: 569px) and (max-width: 768px){
        .point_inning{ position: absolute; top: 0px; font-size: 25px; border-radius: 0%; background: #000d40; padding: 0px 5px; }
        .container-fluid{}
        #conformStop .modal-dialog {max-width: 90%; margin-top: 5%}
        .start_mobi_container{max-width: 100% !important;}
        .start_mobi_container .item_col_player{width: 35%;}
        .start_mobi_container .item_col_main{width: 30%;padding-right:4px; padding-left: 4px}
        .start_mobi_container  button.btn-blue-n{padding: 8px 20px !important} 
        .start_mobi_container button.btn-blue-n .fa {font-size: 20px;}
        .start_mobi_container button.btn-blue-bn {padding: 8px 2px 8px 2px;font-size: 16px}
        .start_mobi_container button.tow_btn_row {line-height: 40px !important; font-size: 16px;}
        .start_mobi_container button.text-over-button{height: 52px; overflow: hidden; line-height: 20px !important;}
        .start_mobi_container button.text-over-button-top{height: 60px; overflow: hidden; line-height: 20px !important;}
        .start_mobi_container .add_diemchodoithu {font-size: 12px;margin-top: 2px}
        .start_mobi_container .start_player_diem {
            border-radius: 50%;
            text-align: center;
            font-size: 100px;
            font-weight: bold;
            color: #000000;
            width: 160px;
            margin: 0 auto;
            vertical-align: middle;
            font-family: utm avo !important;
            text-shadow: rgb(0,0,0, 0.6) 0px 0px 0px;
            position: relative;
            display: table;
        }
        
        .start_mobi_container span.start_player_diem_span1 { top: 8px; left: 8px; font-size: 11px; padding: 5px 5px;}
        .start_mobi_container span.start_player_diem_span2 {top: 8px; right: 8px; font-size: 11px; padding: 5px 5px;}

        .start_mobi_container .main-bgt{background-color: rgba(0, 1, 51, 0.3); border: #056cc3 1px solid; border-radius: 10px; padding: 5px;}
        .start_mobi_container .time_march{
            font-size: 22px !important;
            background: #001d6c;
            border: #013181 1px solid;
            color: #f7941d;
            border-radius: 10px;
            text-align: center;
            font-family: digital-7 mono;
        }
        .start_mobi_container .start_luot_content {font-size:44px !important;}
        .start_mobi_container .cl_luot { 
            text-transform: uppercase;
            font-size: 14px;
            color: #0179df;
            text-align: center;
            font-weight: 300;            
            position: relative;
            padding: 0px 0px 20px  0px;
        }
        .start_mobi_container .main_history_mobi{
            font-size: 13px;
            height: 100%;
            overflow-y: hidden;
            height: 45px;
            text-align: center;
        }
        .start_mobi_container .start_luot_button{ background: #000d40; padding: 0px; border-radius: 5px}
        .start_mobi_container button.btn-blue-bn{
            background: #0261b1;
            border: #0485e9 1px solid;
            box-shadow: #000 0px 2px 2px;
            font-size: 16px;
            text-transform: uppercase;
            border-radius: 16px;
            padding: 5px 2px;
            margin: 0 5px;
            font-family: utm avo;
            font-weight: 500;
            line-height: 14px;
        }
        .start_mobi_container .diem-chap-tv {
            width: 40%;
            float: left;
            font-size: 30px;
            color: #f7941d;
            text-transform: uppercase;
            text-align: center;
            text-shadow: rgb(0,0,0, 0.6) 2px 2px 1px;
            line-height: 30px;
        }
        .start_mobi_container .detail-tv{
            width: 60%;
            float: left;
            font-size: 10px;
            padding-left: 0px;
            text-transform: uppercase;
        }

        .start_mobi_container .start_player_thongke p {
            margin-bottom: 0px !important;
            font-size: 10px;
        }

        .start_mobi_container .title_history_mobi p {margin-bottom: 0px; font-size: 12px;}

        #conformStop .list-diem-a {
            background: linear-gradient(90deg, rgba(1,30,69,1) 0%, rgba(1,45,105,1) 35%, rgba(1,53,124,1) 100%);
            border: #1e93f6 0px solid;padding: 5px 15px;border-radius: 8px;float: left;margin-bottom: 8px ;width: 100%; line-height: 25px
        }
        #conformStop a.btn-blue {
            background: #013584;
            border: #0868bb 1px solid;
            box-shadow: rgb(0,0,0,0.5) 0px 0px 2px;
            font-size: 10px;
            text-transform: uppercase;
            border-radius: 10px;
            padding: 5px 10px;
            margin: 0 5px;
            font-family: utm avo;
            font-weight: 500;
            line-height: 20px;
        }
        #conformStop .start_player_diem_sm {
            border-radius: 50%;
            text-align: center;
            font-size: 65px;
            font-weight: bold;
            color: #000000;
            width: 100px;
            margin: 0 auto;
            vertical-align: middle;
            font-family: utm avo !important;
            text-shadow: rgb(0,0,0, 0.6) 0px 0px 0px;
            position: relative;
            display: table;
        }
        #conformStop .list-diem-a p {font-size: 10px !important;}

        .rows_tk {width: 32% !important; margin-right : 1px !important; margin-left : 1px !important;}
    }

    @media (min-width: 350px) and (max-width: 568px){
        .point_inning{ position: absolute; top: 0px; font-size: 20px; border-radius: 0%; background: #000d40; padding: 0px 5px; }
        .container-fluid{padding-left: 15px !important; padding-right: 15px !important}
        #conformStop .modal-dialog {max-width: 90%; margin-top: 5%}
        .start_mobi_container{max-width: 100% !important;}
        .start_mobi_container .item_col_player{width: 35%;}
        .start_mobi_container .item_col_main{width: 30%;padding-right:4px; padding-left: 4px}
        .start_mobi_container  button.btn-blue-n{padding: 8px 18px !important} 
        .start_mobi_container button.btn-blue-n .fa {font-size: 15px;}   
        .start_mobi_container button.btn-blue-bn {padding: 8px 2px 8px 2px;font-size: 14px}
        .start_mobi_container button.tow_btn_row {line-height: 40px !important; font-size: 14px;}
        .start_mobi_container button.text-over-button{height: 52px; overflow: hidden; line-height: 20px !important;}
        .start_mobi_container button.text-over-button-top{height: 55px; overflow: hidden; line-height: 20px !important;}     
        .start_mobi_container .start_player_diem {
            border-radius: 50%;
            text-align: center;
            font-size: 70px;
            font-weight: bold;
            color: #000000;
            width: 120px;
            margin: 0 auto;
            vertical-align: middle;
            font-family: utm avo !important;
            text-shadow: rgb(0,0,0, 0.6) 0px 0px 0px;
            position: relative;
            display: table;
        }
        .start_mobi_container span.start_player_diem_span1 { top: 0px; left: 0px; font-size: 14px; padding: 2px 2px; border-radius: 50%;}
        .start_mobi_container span.start_player_diem_span2 {top: 0px; right: -7px; font-size: 14px; padding: 2px 2px;}

        .start_mobi_container .main-bgt{background-color: rgba(0, 1, 51, 0.3); border: #056cc3 1px solid; border-radius: 10px; padding: 5px;}
        .start_mobi_container .time_march{ font-size: 18px !important;            }
        .start_mobi_container .start_luot_content {font-size:55px !important;}
        .start_mobi_container .main_history_mobi{
            font-size: 13px;
            height: 100%;
            overflow-y: hidden;
            height: 45px;
            text-align: center;
        }
        .start_mobi_container .start_luot_button{ background: #000d40; padding: 0px; border-radius: 5px}
        .start_mobi_container button.btn-blue-bn{
            background: #0261b1;
            border: #0485e9 1px solid;
            box-shadow: #000 0px 2px 2px;
            font-size: 14px;
            text-transform: lowercase;
            border-radius: 12px;
            padding: 1px 2px;
            margin: 0 5px;
            font-family: utm avo;
            font-weight: 500;
            line-height: 12px;
        }
        .start_mobi_container .diem-chap-tv {
            width: 40%;
            float: left;
            font-size: 22px;
            color: #f7941d;
            text-transform: uppercase;
            text-align: center;
            text-shadow: rgb(0,0,0, 0.6) 2px 2px 1px;
            line-height: 30px;
        }
        .start_mobi_container .detail-tv{
            width: 60%;
            float: left;
            font-size: 8px;
            padding-left: 0px;
            text-transform: uppercase;
        }

        .start_mobi_container .start_player_thongke p {
            margin-bottom: 0px !important;
            font-size: 10px;
        }

        .start_mobi_container .title_history_mobi p {
            margin-bottom: 0px;
            padding: 5px;
            font-size: 8px;
        }

        #conformStop .list-diem-a {
            background: linear-gradient(90deg, rgba(1,30,69,1) 0%, rgba(1,45,105,1) 35%, rgba(1,53,124,1) 100%);
            border: #1e93f6 0px solid;padding: 5px 14px;border-radius: 8px;float: left;margin-bottom: 8px ;width: 100%;
        }
        #conformStop a.btn-blue {
            background: #013584;
            border: #0868bb 1px solid;
            box-shadow: rgb(0,0,0,0.5) 0px 0px;
            font-size: 10px;
            text-transform: uppercase;
            border-radius: 10px;
            padding: 5px 10px;
            margin: 0 5px;
            font-family: utm avo;
            font-weight: 500;
            line-height: 20px;
        }
        #conformStop .start_player_diem_sm {
            border-radius: 50%;
            text-align: center;
            font-size: 65px;
            font-weight: bold;
            color: #000000;
            width: 100px;
            margin: 0 auto;
            vertical-align: middle;
            font-family: utm avo !important;
            text-shadow: rgb(0,0,0, 0.6) 0px 0px 0px;
            position: relative;
            display: table;
        }
        #conformStop .list-diem-a p {font-size: 10px !important;}

        .rows_tk {width: 32% !important; margin-right : 1px !important; margin-left : 1px !important;}
        .chitietthanhvien_icon p {font-size: 14px;}
    }
    
     @media (min-height: 380px) and (max-height: 420px){
        .star-player-main { padding: 15px;}
        .start_mobi_container button.btn-blue-bn {padding: 5px 2px 5px 2px;line-height: 40px;}
        .chitietthanhvien_icon p {font-size: 14px;}
        .start_mobi_container .main_history_mobi{ height: 65px;}
        .pb-14 {padding-bottom: 0px;}
        .start_mobi_container .start_luot_content {font-size: 65px !important;}
     }
     @media (min-height: 361px) and (max-height: 379px){
        .star-player-main { padding: 5px;}
        .start_mobi_container button.btn-blue-bn {padding: 6px 2px 6px 2px;line-height: 40px;}
     }
     @media (min-height: 321px) and (max-height: 360px){
        .start_mobi_container button.btn-blue-bn {padding: 5px 2px 5px 2px;line-height: 40px;}
     }
     @media (min-height: 300px) and (max-height: 320px){
        .start_mobi_container button.btn-blue-bn {padding: 5px 2px 5px 2px;line-height: 40px;}
        .start_mobi_container .start_luot_content {font-size: 27px !important;}
        .start_mobi_container .time_system{font-size: 18px !important;}
     }
</style>
<div class="container start_mobi_container">
    <input type="hidden" id="khaicuoc_user" value="<?php if($trandau['khaicuoc_user']==0) echo $thanhvien1['id']; else echo $trandau['khaicuoc_user']; ?>"/>
    <input type="hidden" id="trandau_id" value="<?=$trandau['id']?>"/>    
    <input type="hidden" id="user1" value="<?=$thanhvien1['id']?>"/>
    <input type="hidden" id="user2" value="<?=$thanhvien2['id']?>"/>
    <input type="hidden" id="user_active" value="<?php if($trandau['khaicuoc_user']==0) echo $thanhvien1['id']; else echo $trandau['khaicuoc_user']; ?>"/>
    <input type="hidden" id="oneAddPoint" value="0"/>
    <input type="hidden" id="timeUser" value="0"/>

    <input type="hidden" id="pointEndUser<?=$thanhvien1['id']?>" value="<?=$diem_ketthuc_player1?>"/>
    <input type="hidden" id="pointEndUser<?=$thanhvien2['id']?>" value="<?=$diem_ketthuc_player2?>"/>
    <input type="hidden" id="pointCurrentUser<?=$thanhvien1['id']?>" value="<?=$currentPointUser1?>"/>
    <input type="hidden" id="pointCurrentUser<?=$thanhvien2['id']?>" value="<?=$currentPointUser2?>"/>

    <div class="start_mobi_2_user">
        <div id="start_player1" class="item_col_player">
            <div class="bgt-blue">
                <div class="star-player-top b-line pt-4 pb-3 pl-4">
                    <div class="row">
                        <div class="w-55 pr-0 pl-3">
                            <h3 class="name-item"><?=$thanhvien1['name']?></h3>
                        </div>
                        <div class="w-45 pl-0" data-toggle="modal" data-target="#chitietthanhvien">
                            <div class="diem-chap-tv">
                                <span style="float: right;"><?=$diem_ketthuc_player1?></span>
                            </div>
                            <div class="detail-tv">
                                <p class="mb-0">High: <span class="color-or"><?=$thanhvien1['avg']?></span></p>
                                <p class="mb-0">AVG: <span class="color-or"><?=$thanhvien1['highrun']?></span></p>
                            </div>
                        </div>
                        <?php include( PATH_APPLICATION . 'view/part/player_info_mobi.php'); ?>
                    </div>
                </div>
                <div id="main_point<?=$thanhvien1['id']?>" class="star-player-main t-line b-line">
                    <span class="point_inning noselect pointInningLeft" id="point_inning<?=$thanhvien1['id']?>">00</span>                    
                    <div id="circle_point<?=$thanhvien1['id']?>" class="start_player_diem <?php if($thanhvien1['id'] == $trandau['khaicuoc_user']) echo 'start_player_diem_color-or'; else echo 'start_player_diem_color-bl';?> button_plus_point" data-id="">
                        <p class="noselect">
                        <span class="noselect" id="point<?=$thanhvien1['id']?>"><?=$currentPointUser1 < 10 ? '0' . $currentPointUser1: $currentPointUser1;?></span>
                        <span class="start_player_diem_span1 noselect" id="timeCurrentUser<?=$thanhvien1['id']?>" style="display: none">00</span>
                        </p>
                    </div>
                    <div class="start_player_button m-auto start_player_button_start_mobi" style="width: 100%; text-align: center;">
                        <button class="button_minus btn btn-primary btn-blue-n button2point<?=$thanhvien1['id']?>" data-id="<?=$thanhvien1['id']?>" style="float: left;">
                            <i class="fa fa-minus" aria-hidden="true"></i>
                        </button>
                        <button class="button_plus button_plus_point btn btn-primary btn-blue-n button2point<?=$thanhvien1['id']?>" data-id="<?=$thanhvien1['id']?>"  style="float: right;">
                            <i class="fa fa-plus"aria-hidden="true"></i>
                        </button>
                        <button class="add_diemchodoithu button_plus_point btn btn-primary btn-blue-n" id="textPoint<?=$thanhvien1['id']?>" data-id="<?=$thanhvien2['id']?>">
                            +<span id="addPoint<?=$thanhvien2['id']?>">1</span> <?=$this->language("l_point_competitor")?>
                        </button>
                    </div>
                </div>
                <div class="start_player_thongke t-line">
                    <div class="row row_thongke" style="margin: 0px">
                        <div class="col-4 r-line row_thongke_detail" >
                            <p class="color-or s-15 mb-1" id="avg<?=$thanhvien1['id']?>"><?=$statisticalUser[1]['avg']?></p>
                            <p>AVG</p>
                        </div>
                        <div class="col-4 r-line l-line row_thongke_detail">
                            <p class="color-or s-15 mb-1" id="hight<?=$thanhvien1['id']?>"><?=$statisticalUser[1]['hight']?></p>
                            <p><?=$this->language("l_high")?></p>
                        </div>
                        <div class="col-4 r-line l-line row_thongke_detail">
                            <p class="color-or s-15 mb-1" id="sobicham<?=$thanhvien1['id']?>"><?=$statisticalUser[1]['number_balltouches']?></p>
                            <p><?=$this->language("l_numbercham")?></p>
                        </div>                        
                    </div>
                </div>  
                <div class="start_player_history t-line">
                    <?php include( PATH_APPLICATION . 'view/part/start_player_history1_mobi.php'); ?>                                          
                </div>
            </div>
        </div>
        <!---------------------------center--------------------------->
        <div class="item_col_main">
            <div class="main-bgt">
                <div class="time_march"  style="position: relative;">
                    <div id="divsound">
                        <img class="img-fluid" onclick="changesound(0)" src="<?= URL_PUBLIC ?>images/s_on.png" />
                    </div>
                    <p style="margin-bottom: 0px;" id="countTimeMarch">00:00</p>
                </div>
                <input type="hidden" id="status_sound" value="1" />
                <style>
                    #divsound{position: absolute; top: 0px; left: 0px;}                    
                </style>
                <div class="start_luot_content">
                    <p class="button_tranfer number_inning noselect" id="number_inning"><?=$innering;?></p>
                    <p class="cl_luot text_inning noselect"><?=$this->language("l_inning")?></p>
                </div>
                <div class="start_luot_button">
                    <div>
                        <button type="button" class="button_tranfer btn btn-primary btn-blue-bn tow_btn_row text-over-button-top w-100 mb-1 ml-0"><?=$this->language("l_button_tranfer_model2")?></button>
                    </div>
                    <div class="button_tranfer_cancel">
                        <div class="div_tow_button" style="padding-right: 2px">
                            <button type="button" class="button_cancel btn btn-primary btn-blue-bn tow_btn_row text-over-button w-100 mb-1 ml-0"><?=$this->language("l_button_cancel_model2")?></button>
                        </div>
                        <div class="div_tow_button" style="padding-left: 2px">
                            <button type="button" class="cbutton btn btn-primary btn-blue-bn tow_btn_row text-over-button w-100 ml-0" style="margin-bottom: 4px;"><?=$this->language("l_button_cbutton_model2")?></button>
                        </div>                            
                    </div>                                                                                
                    <div class="button_pause_stop_reset">
                        <div class="div_tow_button" style="padding-right: 2px">
                            <button type="button" class="button_pause btn btn-primary btn-blue-bn tow_btn_row text-over-button w-100 mb-1 ml-0"><?=$this->language("l_button_pause_model2")?></button>
                        </div>
                        <div class="div_tow_button" style="padding-left: 2px">
                            <button type="button" class="resettime btn btn-primary btn-orange tow_btn_row text-over-button w-100 mb-1 ml-0"><?=$this->language("l_button_resettime_model2")?></button>
                        </div>
                        <div class="div_tow_button" style="padding-left: 2px">
                            <button type="button" class="button_stop btn btn-primary btn-blue-bn tow_btn_row text-over-button w-100 mb-1 ml-0"  data-toggle="modal" data-target="#KetThucTranDauModal"><?=$this->language("l_button_stop_model2")?></button>                        
                        </div> 
                        <div style="clear: both"></div>                       
                    </div>
                    <div class="time_system">
                        <p id="countTimeSystem"><?= date('H') ?>:<?= date('i') ?>:<?= date('s') ?></p>
                    </div>
                </div>
            </div>
        </div>
        <!---------------------------end center--------------------------->
        <div id="start_player2" class="item_col_player">
            <div class="bgt-blue">
                <div class="star-player-top b-line pt-4 pb-3 pl-4">
                    <div class="row">
                        <div class="w-55 pr-0 pl-3">
                            <h3 class="name-item"><?=$thanhvien2['name']?></h3>
                        </div>
                        <div class="w-45" data-toggle="modal" data-target="#chitietthanhvien2">
                            <div class="diem-chap-tv">
                                <span style="float: right;"><?=$diem_ketthuc_player2?></span>
                            </div>
                            <div class="detail-tv">
                                <p class="mb-0">High: <span class="color-or"><?=$thanhvien1['highrun']?></span></p>
                                <p class="mb-0">AVG: <span class="color-or"><?=$thanhvien1['avg']?></span></p>
                            </div>
                        </div>
                        <?php include( PATH_APPLICATION . 'view/part/player_info2_mobi.php'); ?>
                    </div>
                </div>
                <div id="main_point<?=$thanhvien2['id']?>" class="star-player-main t-line b-line-d">
                    <span class="point_inning noselect pointInningRight" id="point_inning<?=$thanhvien2['id']?>">00</span>
                    <div id="circle_point<?=$thanhvien2['id']?>" class="start_player_diem <?php if($thanhvien2['id'] == $trandau['khaicuoc_user']) echo 'start_player_diem_color-or'; else echo 'start_player_diem_color-bl';?> button_plus_point" data-id="">
                        <p class="noselect">
                        <span class="noselect" id="point<?=$thanhvien2['id']?>"><?=$currentPointUser2 < 10 ? '0' . $currentPointUser2: $currentPointUser2;?></span>
                        <span class="start_player_diem_span2 noselect" id="timeCurrentUser<?=$thanhvien2['id']?>" style="display: none">00</span>                        
                        </p>
                    </div>
                    <div class="start_player_button m-auto start_player_button_start_mobi" style="width: 100%; text-align: center;">                        
                        <button class="button_minus btn btn-primary btn-blue-n button2point<?=$thanhvien2['id']?>"data-id="<?=$thanhvien2['id']?>"  style="float: left">
                            <i class="fa fa-minus" aria-hidden="true"></i>
                        </button>
                        <button class="button_plus button_plus_point btn btn-primary btn-blue-n button2point<?=$thanhvien2['id']?>" data-id="<?=$thanhvien2['id']?>" style="float: right">
                            <i class="fa fa-plus"aria-hidden="true"></i>
                        </button>
                        <button class="add_diemchodoithu button_plus_point btn btn-primary btn-blue-n" id="textPoint<?=$thanhvien2['id']?>" data-id="<?=$thanhvien1['id']?>" >
                            +<span id="addPoint<?=$thanhvien1['id']?>">1</span> <?=$this->language("l_point_competitor")?>
                        </button>
                    </div>
                </div>
                <div class="start_player_thongke t-line ">
                    <div class="row row_thongke" style="margin: 0px">
                        <div class="col-4 r-line row_thongke_detail" >
                            <p class="color-or s-15 mb-1" id="avg<?=$thanhvien2['id']?>"><?=$statisticalUser[2]['avg']?></p>
                            <p>AVG</p>
                        </div>
                        <div class="col-4 r-line l-line row_thongke_detail">
                            <p class="color-or s-15 mb-1" id="hight<?=$thanhvien2['id']?>"><?=$statisticalUser[2]['hight']?></p>
                            <p><?=$this->language("l_high")?></p>
                        </div>
                        <div class="col-4 r-line l-line row_thongke_detail">
                            <p class="color-or s-15 mb-1" id="sobicham<?=$thanhvien2['id']?>"><?=$statisticalUser[2]['number_balltouches']?></p>
                            <p><?=$this->language("l_numbercham")?></p>
                        </div>                        
                    </div>
                </div>  
                <div class="start_player_history t-line">
                    <?php include( PATH_APPLICATION . 'view/part/start_player_history2_mobi.php'); ?>                                        
                </div>
            </div>
        </div>
    </div>
</div>

<?php include( PATH_APPLICATION . 'view/part/conform_stop_mobi.php'); ?>
<script type="text/javascript">
    var minutes = <?=$minutes?>;
    var hour = <?=$hour?>;
    var time;
    var timerOn = 0;
    var minutesPlay = <?=$trandau['thoigian']?>;  

    function timedCount()
    {
        hour = parseInt(hour);
        minutes = parseInt(minutes);        
                
        if(minutes < 10) {
            txtMinutes = '0' + parseInt(minutes);
        } else {
            txtMinutes = parseInt(minutes);
        }
        if(hour < 10) {
            txtHour = '0' + parseInt(hour);
        } else {
            txtHour = parseInt(hour);   
        }

        $('#countTimeMarch').html(txtHour + ':' + txtMinutes);

        minutes = minutes+1;
        if (minutes%60==0){
            hour+=1;
            minutes=0;
        }
        if (minutes%60==0){
            hour+=1;
            minutes=0;
        }

        minutesExpired = minutesPlay * 60;
        minutesCurrent = hour * 3600 + minutes * 60;
        if(minutesExpired > 0 &&  minutesExpired < minutesCurrent){
            var dataId = $('#user_active').val();
            disableButton(1);
            var time = $('#timeUser').val();
            var idTrandau = $('#trandau_id').val();
            var nextPoint = $('#oneAddPoint').val();
            $('.div_load_alert').css("display","block");
            var url = $baseUrl + '/martchend_pointtime.html';
            $.ajax({
                url: url,
                type: 'POST',
                data: {
                    trandau_id:idTrandau,
                    thanhvien_id:dataId,
                    diem:nextPoint,
                    time:time,
                    status: 1
                },
                dataType:'text',                
                success:function(data){             
                    jsonData =  $.parseJSON(data);
                    if(jsonData.status == true){
                        //update history                        
                        $('.div_load_alert').css("display","none");                        
                        $('#avg' + dataId).html(jsonData.avg);
                        $('#hight' + dataId).html(jsonData.hight);
                        $('#sobicham' + dataId).html(jsonData.number_balltouches);
                        $('#time' + dataId).html(jsonData.total_time + 's'); 

                        $('#timeCurrentUser' + dataId).hide();
                        hiddenButton(1);                                                                                                                                                           
                        calculateTheEndMarch();                                        
                        $('#conformStop').modal();
                        return false;
                                            
                    } else {                    
                        return false;
                    }
                }
            });            
        };

        time = setTimeout("timedCount()",60000);
    }

    function start()
    {
        if (!timerOn)
        {
            timerOn =1;
            timedCount();
        }
    }

    function stop() {
        if (time) {
            timerOn=0;
            clearTimeout(time);
        }
    }

    // Caculater time User 
    var secondUseCurrent = 0;
    var timeUse;
    var timerOnUser = 0;
    var user1 = <?=$thanhvien1['id']?>;
    var user2 = <?=$thanhvien2['id']?>;
    var khaicuocId = $('#khaicuoc_user').val();
    currentUser =0;
    <?php if($currentUser){?>
        var currentUser = khaicuocId;
    <?php } else { ?>
        if(khaicuocId == user1) currentUser = user2; 
        if(khaicuocId == user2) currentUser = user1;
    <?php } ?>     

    if (localStorage.hasOwnProperty("secondUseCurrent")) {    
    	secondUseCurrent=parseInt(localStorage.getItem("secondUseCurrent"));
    }
    function timedCountCurrentUser()
    {
        if(secondUseCurrent < 10) {
            txtSecond = '0' + parseInt(secondUseCurrent);
        } else {
            txtSecond = parseInt(secondUseCurrent);   
        }
        localStorage.setItem("secondUseCurrent",secondUseCurrent); 
        secondUseCurrent = secondUseCurrent + 1;
        $('#timeCurrentUser' + currentUser).html(txtSecond);
        $('#timeCurrentUser' + currentUser).show(); 
        $('#timeUser').val(secondUseCurrent);        
        timeUse = setTimeout("timedCountCurrentUser()",1000);
    }
    function startCountTimeUser()
    {
        if (!timerOnUser)
        {
            timerOnUser =1;
            timedCountCurrentUser();
        }
    }

    function stopCountTimeUser() {        
       
        if (timeUse) {
            timerOnUser=0;
            clearTimeout(timeUse);
        }
    }

    window.setTimeout("showTime()", 1000);
    function getSystemTime() {
        var time = new Date();                
        var hr = time.getHours();
        var min = time.getMinutes();
        var sec = time.getSeconds();

        hr = ((hr < 10) ? "0" : "") + hr;
        min = ((min < 10) ? "0" : "") + min;
        sec = ((sec < 10) ? "0" : "") + sec;
        return hr + ":" + min + ":" + sec;
    }
    function showTime() {
        var clock = document.getElementById("countTimeSystem");
        if (clock != null)
            clock.innerHTML = getSystemTime();
        setTimeout("showTime()", 1000);
    }

    function calculateTheEndMarch(){
        var userId1 = $('#user1').val();
        var userId2 = $('#user2').val();
        var pointEndUser1 = parseInt($('#pointEndUser' + userId1).val());
        var pointEndUser2 = parseInt($('#pointEndUser' + userId2).val());

        var currentPointUser1 = parseInt($('#point' + userId1).html());
        var currentPointUser2 = parseInt($('#point' + userId2).html());
        var luotcodangdanh = $('#number_inning').html();
        
        if(currentPointUser1 < pointEndUser1 && currentPointUser2 < pointEndUser2){
            if(currentPointUser1 > currentPointUser2){
                $('.user_win' + userId1).addClass('start_player_diem_color-or');
                $('.user_win' + userId1).removeClass('start_player_diem_color-bl');
                $('.user_win' + userId2).removeClass('start_player_diem_color-or');
                $('.user_win' + userId2).addClass('start_player_diem_color-bl');    
            } else if(pointEndUser1 < pointEndUser2){
                $('.user_win' + userId2).addClass('start_player_diem_color-or');
                $('.user_win' + userId2).removeClass('start_player_diem_color-bl');
                $('.user_win' + userId1).removeClass('start_player_diem_color-or');
                $('.user_win' + userId1).addClass('start_player_diem_color-bl');
            }    
        } else {
            if(currentPointUser1 == pointEndUser1){
                $('.user_win' + userId1).addClass('start_player_diem_color-or');
                $('.user_win' + userId1).removeClass('start_player_diem_color-bl');
                $('.user_win' + userId2).removeClass('start_player_diem_color-or');
                $('.user_win' + userId2).addClass('start_player_diem_color-bl');
            }

            if(currentPointUser2 == pointEndUser2){
                $('.user_win' + userId2).addClass('start_player_diem_color-or');
                $('.user_win' + userId2).removeClass('start_player_diem_color-bl');
                $('.user_win' + userId1).removeClass('start_player_diem_color-or');
                $('.user_win' + userId1).addClass('start_player_diem_color-bl');
            }
        }
        

        if(currentPointUser1 == currentPointUser2 && currentPointUser1 < pointEndUser1 & currentPointUser2 < pointEndUser2){
            var userkhaicuoc = $('#khaicuoc_user').val();            
            if(userkhaicuoc == userId1){
                $('.user_win' + userId1).removeClass('start_player_diem_color-bl');
                $('.user_win' + userId1).addClass('start_player_diem_color-or');
                $('.user_win' + userId2).removeClass('start_player_diem_color-or');
                $('.user_win' + userId2).addClass('start_player_diem_color-bl');
            } else {
                $('.user_win' + userId2).removeClass('start_player_diem_color-bl');
                $('.user_win' + userId2).addClass('start_player_diem_color-or');
                $('.user_win' + userId1).removeClass('start_player_diem_color-or');
                $('.user_win' + userId1).addClass('start_player_diem_color-bl');
            }
        }

        if(currentPointUser1 < 10) currentPointUser1 = '0' + currentPointUser1;
        if(currentPointUser2 < 10) currentPointUser2 = '0' + currentPointUser2;
        
        $('.pointend' + userId1).html(currentPointUser1);
        $('.diemend' + userId1).html(pointEndUser1);
        $('.hightend' + userId1).html($('#hight' + userId1).html());
        $('.luotcoend' + userId1).html(luotcodangdanh);
        $('.avgend' + userId1).html($('#avg' + userId1).html());
        

        $('.pointend' + userId2).html(currentPointUser2);
        $('.diemend' + userId2).html(pointEndUser2);
        $('.hightend' + userId2).html($('#hight' + userId2).html());
        $('.luotcoend' + userId2).html(luotcodangdanh);
        $('.avgend' + userId2).html($('#avg' + userId2).html());
        $('.luotcodangdanh').html(luotcodangdanh);
        stop();
        //stopCountTimeUser();
    }

    function disableButton(option){
        //the end martch
        if(option == 1){
            $('.button_plus_point').attr('disabled', true);
            $('.button_minus').attr('disabled', true); 
            $('.button_tranfer').attr('disabled', true);
            $('.button_cancel').attr('disabled', true);
            $('.button_pause').attr('disabled', true);
            $('.cbutton').attr('disabled', true);
            $('.button_stop').attr('disabled', false);
        } else {
            $('.button_plus_point').attr('disabled', false);
            $('.button_minus').attr('disabled', false); 
            $('.button_tranfer').attr('disabled', false);
            $('.button_cancel').attr('disabled', false);
            $('.button_pause').attr('disabled', false);
            $('.button_stop').attr('disabled', false);
        }
    }

    function hiddenButton(option){
        //the end martch
        if(option == 1){
            $('#btnExit').show();
            $('#btnChonlaicothu').show();
            $('#btnResetGame').show();
            $('#btnStop').hide();
            $('#btnCancel').show();
        }
        //stop game
        if(option == 2){
            $('#btnStop').show();            
            $('#btnResetGame').show();
            $('#btnChonlaicothu').show();
            $('#btnCancel').show();
            $('#btnExit').hide();
        }
    }

    function changesound(status){
        if(status==0){
            document.getElementById("status_sound").value=0;
            $("#divsound").html('<img onclick="changesound(1)" src="<?= URL_BASE ?>/public/images/s_off.png" />')
        }else{
            document.getElementById("status_sound").value=1;
            $("#divsound").html('<img onclick="changesound(0)" src="<?= URL_BASE ?>/public/images/s_on.png" />')
        }
    }

    $('body').on('click', '.button_tranfer', function(){ 
               
        var time = $('#timeUser').val();
        secondUseCurrent = 0;
        hidden = currentUser;
        if(currentUser == user1) {
            currentUser = user2;
        } else {
            currentUser = user1;
        }      

        //luot show
        var currentluotco = parseInt($("#number_inning").html());
        var user_khaicuoc = $('#khaicuoc_user').val();
        if(user_khaicuoc == currentUser){
            $("#number_inning").html(currentluotco + 1);
        }

        $('#timeCurrentUser' + hidden).hide();
        $('#timeCurrentUser' + currentUser).show();
        stopCountTimeUser();
        startCountTimeUser();

        $('#main_point' + hidden).removeClass('background_player_active');
        $('#main_point' + currentUser).addClass('background_player_active');
        $('#circle_point' + hidden).attr('data-id', currentUser); 
        $('#circle_point' + currentUser).attr('data-id', currentUser);
        $('#point_inning' + currentUser).html('00'); 

        var idTrandau = $('#trandau_id').val();
        var idUser = hidden;
        var point = $('#oneAddPoint').val();
        $('#oneAddPoint').val(0);        
        $('.button2point' + currentUser).show();
        $('#textPoint' + currentUser).hide();
        $('.button2point' + hidden).hide();
        $('#textPoint' + hidden).show();           
        
        var status_sound = document.getElementById("status_sound").value;
        if(status_sound==1){
            var music = new Audio("<?= URL_BASE ?>/public/sound/tranfer_" + point + "_" +lang+".mp3");
            music.play();
        } 

        var strload='<img class="imagesload_wait_button_change_turn" src="'+$baseUrl+'/public/img/load.gif" />';
        var url = $baseUrl + '/changeturns.html';
        $.ajax({
            url: url,
            type: 'POST',
            data: {
                trandau_id:idTrandau,
                thanhvien_id:idUser,
                diem:point,
                time:time,
                status: 1
            },
            dataType:'text',
            beforeSend: function() {
                //$('.button_tranfer').after(strload);
                //$('.button_tranfer').attr('disabled', true);
                //$('.button_cancel').attr('disabled', true);
            },
            success:function(data){             
                jsonData =  $.parseJSON(data);

                if(jsonData.status == true){
                    //update history
                    //$('.imagesload_wait_button_change_turn').remove();
                    //$('.button_tranfer').attr('disabled', false);
                    //$('.button_cancel').attr('disabled', false);

                    $('.rowUser' + hidden).removeClass('rowUser' + hidden);
                    str = '<div class="row b-line-d t-line-d m-0 pb-14 rows_history rowUser' + hidden +'">';                       
                       str += '<div class="col-4 pt-2"><p class="mb-1">' + jsonData.inning + '</p></div>';
                       str += '<div class="col-4 pt-2"><p class="mb-1">' + jsonData.score + '</p></div>';
                       str += '<div class="col-4 pt-2"><p class="mb-1">' + jsonData.shot + '</p></div>';                       
                    str +='</div>';
                    $(str).insertBefore('.rowshow' + hidden);
                    $('.rowshow' + hidden).remove();  

                    $('#user_active').val(currentUser);                                        
                                                                                                
                    $("#pointCurrentUser" + hidden).val(jsonData.diem);                    
                    if(currentluotco < parseInt(jsonData.luotco)){
                        $("#number_inning").html(jsonData.luotco);
                        strshowuser1 = '<div class="row b-line-d t-line-d m-0 pb-14 rows_history rowshow' + hidden +'">';                           
                           strshowuser1 += '<div class="col-4 pt-2"><p>' + jsonData.luotco + '</p></div>';
                           strshowuser1 += '<div class="col-4 pt-2"><p class="mb-1 rowshowPoint' + hidden + '">0</p></div>';
                           strshowuser1 += '<div class="col-4 pt-2"><p class="mb-1 rowshowTime' + hidden + '">0</p></div>';                           
                        strshowuser1 +='</div>';
                        $(strshowuser1).insertBefore('.rowUser' + hidden);                                                                 

                        strshowuser2 = '<div class="row b-line-d t-line-d m-0 pb-14 rows_history rowshow' + currentUser +'">';                           
                           strshowuser2 += '<div class="col-4 pt-2"><p>' + jsonData.luotco + '</p></div>';
                           strshowuser2 += '<div class="col-4 pt-2"><p class="mb-1 rowshowPoint' + currentUser + '">0</p></div>';
                           strshowuser2 += '<div class="col-4 pt-2"><p class="mb-1 rowshowTime' + currentUser + '">0</p></div>';                           
                        strshowuser2 +='</div>';
                        $(strshowuser2).insertBefore('.rowUser' + currentUser); 
                    }     
                                        
                    $('#avg' + hidden).html(jsonData.avg);
                    $('#hight' + hidden).html(jsonData.hight);
                    $('#sobicham' + hidden).html(jsonData.number_balltouches);
                    $('#time' + hidden).html(jsonData.total_time);  
                    
                    if(parseInt(jsonData.the_end)==1){
                        $("#number_inning").html(jsonData.luotco);                        
                        $('#timeCurrentUser' + currentUser).hide();
                        $('#btnExit').show();
                        $('#btnStop').hide();
                        $('#btnCancel').hide();
                        $('.div_button_tranfer').hide();
                        $('.div_button_cancel').hide();
                        $('.div_button_pause').hide();
                        $('.div_button_stop').hide();
                        $('.button_plus').attr('disabled', true);
                        $('.button_minus').attr('disabled', true);
                        $('.add_diemchodoithu').attr('disabled', true);
                        $('.div_button_reset').attr('disabled', true); 
                        $('.div_button_reset').show();                         
                        calculateTheEndMarch();
                        $('#conformStop').modal();
                        return false;
                    }                    
                } else {                    
                    return false;
                }

            }
        });               
    });

    $('body').on('click', '.button_cancel', function(){
        var status_sound = document.getElementById("status_sound").value;
        if(status_sound==1){
            var music = new Audio("<?= URL_BASE ?>/public/sound/cancel_"+lang+".mp3");
            music.play();
        }
        var time = $('#timeUser').val();
        secondUseCurrent = 0;
        hidden = currentUser;
        if(currentUser == user1) {
            currentUser = user2;
        } else {
            currentUser = user1;
        }  

        //luot show
        var currentluotco = parseInt($("#number_inning").html());
        var user_khaicuoc = $('#khaicuoc_user').val();
        if(user_khaicuoc == currentUser){
            $("#number_inning").html(currentluotco + 1);
        }

        $('#timeCurrentUser' + hidden).hide();
        $('#timeCurrentUser' + currentUser).show();
        stopCountTimeUser();
        startCountTimeUser();
        
        $('#main_point' + hidden).removeClass('background_player_active');
        $('#main_point' + currentUser).addClass('background_player_active');
        $('#circle_point' + hidden).attr('data-id', currentUser); 
        $('#circle_point' + currentUser).attr('data-id', currentUser); 

        $('#point_inning' + hidden).html('00');

        var idTrandau = $('#trandau_id').val();
        var idUser = hidden;
        var point = $('#oneAddPoint').val();        
        $('.button2point' + currentUser).show();
        $('#textPoint' + currentUser).hide();
        $('.button2point' + hidden).hide();
        $('#textPoint' + hidden).show();

        var strload='<img class="imagesload_wait_button_cancel" src="'+$baseUrl+'/public/img/load.gif" />';
        var url = $baseUrl + '/changeturns.html';
        $.ajax({
            url: url,
            type: 'POST',
            data: {
                trandau_id:idTrandau,
                thanhvien_id:idUser,
                diem:point,
                time:time,
                status: 0
            },
            dataType:'text',
            beforeSend: function() {
                //$('.button_cancel').after(strload);
                //$('.button_tranfer').attr('disabled', true);
                //$('.button_cancel').attr('disabled', true);
            },
            success:function(data){             
                jsonData =  $.parseJSON(data);
                if(jsonData.status == true){
                    //$('.imagesload_wait_button_cancel').remove();
                    //$('.button_tranfer').attr('disabled', false);
                    //$('.button_cancel').attr('disabled', false);

                    if(parseInt(jsonData.diem) < 10){
                        jsonData.diem = '0' + jsonData.diem; 
                    }
                    $('.rowUser' + hidden).removeClass('rowUser' + hidden);
                    str = '<div class="row b-line-d t-line-d m-0 pb-14 rows_history rows_history_cancel rowUser' + hidden +'">';                
                       str += '<div class="col-4 pt-2"><p>' + jsonData.inning + '</p></div>';
                       str += '<div class="col-4 pt-2"><p>' + jsonData.score + '</p></div>';
                       str += '<div class="col-4 pt-2"><p>' + jsonData.shot + '</p></div>';                       
                    str +='</div>';
                    $(str).insertBefore('.rowshow' + hidden);
                    $('.rowshow' + hidden).remove();

                    $('#user_active').val(currentUser);
                    $('#oneAddPoint').val(0);                                            
                    $('#point' + hidden).html(jsonData.diem)                                                                              
                    $("#pointCurrentUser" + hidden).val(jsonData.diem);     
                                        
                    if(currentluotco < parseInt(jsonData.luotco)){
                        $("#number_inning").html(jsonData.luotco);
                        strshowuser1 = '<div class="row b-line-d t-line-d m-0 pb-14 rows_history rowshow' + hidden +'">';                           
                           strshowuser1 += '<div class="col-4 pt-2"><p>' + jsonData.luotco + '</p></div>';
                           strshowuser1 += '<div class="col-4 pt-2"><p class="rowshowPoint' + hidden + '">0</p></div>';
                           strshowuser1 += '<div class="col-4 pt-2"><p class="rowshowTime' + hidden + '">0</p></div>';                           
                        strshowuser1 +='</div>';
                        $(strshowuser1).insertBefore('.rowUser' + hidden);                                                                 

                        strshowuser2 = '<div class="row b-line-d t-line-d m-0 pb-14 rows_history rowshow' + currentUser +'">';                           
                           strshowuser2 += '<div class="col-4 pt-2"><p>' + jsonData.luotco + '</p></div>';
                           strshowuser2 += '<div class="col-4 pt-2"><p class="rowshowPoint' + currentUser + '">0</p></div>';
                           strshowuser2 += '<div class="col-4 pt-2"><p class="rowshowTime' + currentUser + '">0</p></div>';                           
                        strshowuser2 +='</div>';
                        $(strshowuser2).insertBefore('.rowUser' + currentUser); 
                    } 
                    if(parseInt(jsonData.the_end)==1){
                        $("#number_inning").html(jsonData.luotco);                        
                        $('#timeCurrentUser' + currentUser).hide();
                        $('#btnExit').show();
                        $('#btnStop').hide();
                        $('#btnCancel').hide();
                        $('.div_button_tranfer').hide();
                        $('.div_button_cancel').hide();
                        $('.div_button_pause').hide();
                        $('.div_button_stop').hide();
                        $('.button_plus').attr('disabled', true);
                        $('.button_minus').attr('disabled', true);
                        $('.add_diemchodoithu').attr('disabled', true);
                        $('.div_button_reset').attr('disabled', true); 
                        $('.div_button_reset').show();                         
                        calculateTheEndMarch();
                                               
                        $('#conformStop').modal();
                        return false;
                    }                                                                                                 
                } else {                                        
                    return false;     
                }
            }
        });
    })

    $('.button_stop').on('click', function(){  
        var status_sound = document.getElementById("status_sound").value;      
        if(status_sound==1){
            var music = new Audio("<?= URL_BASE ?>/public/sound/ok_stop_kr.mp3");
            music.play();
        }  
        calculateTheEndMarch();
        $('#btnStop').show();
        $('#btnExit').hide();
        $("#conformStop").modal();
    })

    $('.button_pause').on('click', function(){
        var status_sound = document.getElementById("status_sound").value;
        if(status_sound==1){
            var music = new Audio("<?= URL_BASE ?>/public/sound/pause_"+lang+".mp3");
            music.play();
        }          
        $('.button_tranfer').attr('disabled', true);
        $('.button_cancel').attr('disabled', true);
        $('.button_stop').attr('disabled', false);
        $('.cbutton').attr('disabled', true);
        $('.button_plus').attr('disabled', true);
        $('.button_minus').attr('disabled', true);
        $('.add_diemchodoithu').attr('disabled', true);
        $('.resettime').show();
        $('.button_pause').hide();
        
        $('.start_player_diem').removeClass('button_plus_point');        
        stopCountTimeUser();
    })
    
    $('.resettime').on('click', function(){  
        var status_sound = document.getElementById("status_sound").value;
        if(status_sound==1){
            var music = new Audio("<?= URL_BASE ?>/public/sound/continue_"+lang+".mp3");
            music.play();
        }    
        $('.button_tranfer').attr('disabled', false);
        $('.button_cancel').attr('disabled', false);
        $('.button_stop').attr('disabled', false);
        $('.resettime').hide();
        $('.button_pause').show();

        $('.cbutton').attr('disabled', false);
        $('.button_plus').attr('disabled', false);
        $('.button_minus').attr('disabled', false);
        $('.add_diemchodoithu').attr('disabled', false); 
        $('.start_player_diem').addClass('button_plus_point');       
        secondUseCurrent =0;
        startCountTimeUser();
    })

    $('#btnResetGame').on('click', function(){     
        $('.div_load_alert').css("display","block");        
        $.fn_ajax('reset', {'trandau_id': <?=$trandau_id?>}, function (result) {
            if (result.flag == true) {
                window.location = "<?= $this->route('start.html/') ?>" + result.trandau_id;
            }
        }, true);        
        stopCountTimeUser();
        secondUseCurrent = -2;
        startCountTimeUser();
    })

    $('body').on('click', '.button_plus_point', function(){        
        
        var dataId =$(this).attr('data-id');
        var user1 = document.getElementById("user1").value;
        var user2 = document.getElementById("user2").value;
        if(dataId == user1){
            var otherUser = user2;
        } else {
            var otherUser = user1;
        }
        var endPointUser = $("#pointEndUser" + dataId).val();
        var currentPointUser = $("#pointCurrentUser" + dataId).val();
        var currentAddPoint = $('#oneAddPoint').val();
        var nextPoint = parseInt(currentAddPoint) + 1;
        var TotalPoint = nextPoint + parseInt(currentPointUser);
        var timeUser = $('#timeUser').val();            
        $('.rowshowPoint' + dataId).html(nextPoint);        
        $('.rowshowTime' + dataId).html(timeUser); 

        if(nextPoint < 10){
            $('#point_inning' + dataId).html( '0' + nextPoint);
        } else{
            $('#point_inning' + dataId).html(nextPoint);
        }        

        if(parseInt(endPointUser) > parseInt(TotalPoint)){                       
            if(TotalPoint < 10) TotalPoint = '0' + parseInt(TotalPoint);
            $('#point' + dataId).html(TotalPoint); 
            $('#oneAddPoint').val(nextPoint);
        }

        if(endPointUser == TotalPoint){            
            if(TotalPoint < 10) TotalPoint = '0' + parseInt(TotalPoint);
            $('#point' + dataId).html(TotalPoint); 
            $('#oneAddPoint').val(nextPoint);                        
            disableButton(1);
            var time = $('#timeUser').val();
            var idTrandau = $('#trandau_id').val();

            $('.div_load_alert').css("display","block");
            var url = $baseUrl + '/martchend_pointtime.html';
            $.ajax({
                url: url,
                type: 'POST',
                data: {
                    trandau_id:idTrandau,
                    thanhvien_id:dataId,
                    diem:nextPoint,
                    time:time,
                    status: 3
                },
                dataType:'text',                
                success:function(data){             
                    jsonData =  $.parseJSON(data);
                    if(jsonData.status == true){
                        //update history                        
                        $('.div_load_alert').css("display","none");                        
                        $('#avg' + dataId).html(jsonData.avg);
                        $('#hight' + dataId).html(jsonData.hight);
                        $('#sobicham' + dataId).html(jsonData.number_balltouches);
                        $('#time' + dataId).html(jsonData.total_time); 

                        $('#timeCurrentUser' + dataId).hide();
                        hiddenButton(1);                                                                                                                                                           
                        calculateTheEndMarch();                                        
                        $('#conformStop').modal();
                        return false;
                                            
                    } else {                    
                        return false;
                    }
                }
            });                                  
        } 
        var status_sound = document.getElementById("status_sound").value;
        if(status_sound==1){
            if(endPointUser - TotalPoint <= 5){
                if(endPointUser - TotalPoint == 5){
                    var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_5" + "_" +lang+".mp3");
                }
                if(endPointUser - TotalPoint == 4){
                    var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_4" + "_" +lang+".mp3");
                }
                if(endPointUser - TotalPoint == 3){
                    var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_3" + "_" +lang+".mp3");
                }
                if(endPointUser - TotalPoint == 2){
                    var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_2" + "_" +lang+".mp3");
                } 
                if(endPointUser - TotalPoint == 1){
                    var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_1" + "_" +lang+".mp3");
                }
            } else {
                var music = new Audio("<?= URL_BASE ?>/public/sound/addpoint_" + nextPoint + "_" +lang+".mp3");    
            }            
            music.play();
        }

        stopCountTimeUser();
        secondUseCurrent =0;
        startCountTimeUser();
    })

    $('body').on('click', '.button_minus', function(){
        
        var dataId =$(this).attr('data-id');
        var user1 = document.getElementById("user1").value;
        var user2 = document.getElementById("user2").value;
        if(dataId == user1){
            var otherUser = user2;
        } else {
            var otherUser = user1;
        }
        var currentPoint = parseInt($('#oneAddPoint').val());
        if(currentPoint){
            var nextPoint = currentPoint - 1;
            var timeUser = $('#timeUser').val();
            $('.rowshowPoint' + dataId).html(nextPoint);    
            $('.rowshowTime' + dataId).html(timeUser);                  
            $('#oneAddPoint').val(nextPoint);           
            var TotalPoint = parseInt($('#point' + dataId).html());
            var TotalPointNext = TotalPoint -1; 
            if(TotalPoint < 10) TotalPointNext = '0' + TotalPointNext;
            $('#point' + dataId).html(TotalPointNext);  

            if(nextPoint < 10){
                $('#point_inning' + dataId).html( '0' + nextPoint);
            } else{
                $('#point_inning' + dataId).html(nextPoint);
            }

            var endPointUser = $("#pointEndUser" + dataId).val();
            var status_sound = document.getElementById("status_sound").value;
            if(status_sound==1){
                if(endPointUser - TotalPointNext <= 5){
                    if(endPointUser - TotalPointNext == 5){
                        var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_5" + "_" +lang+".mp3");
                    }
                    if(endPointUser - TotalPointNext == 4){
                        var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_4" + "_" +lang+".mp3");
                    }
                    if(endPointUser - TotalPointNext == 3){
                        var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_3" + "_" +lang+".mp3");
                    }
                    if(endPointUser - TotalPointNext == 2){
                        var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_2" + "_" +lang+".mp3");
                    } 
                    if(endPointUser - TotalPointNext == 1){
                        var music = new Audio("<?= URL_BASE ?>/public/sound/leftpoint_1" + "_" +lang+".mp3");
                    }
                } else {
                    var music = new Audio("<?= URL_BASE ?>/public/sound/subpoint_"+lang+".mp3");
                }            
                music.play();
            } 
        }
        stopCountTimeUser();
        secondUseCurrent =0;
        startCountTimeUser();
    })
</script>
<div class="div_load_alert">
    <div class="main_mess">
        <p><?= $this->language("l_main_mess") ?></p>
        <img style="width: 200px;" src="<?=URL_PUBLIC?>img/load.gif" />
    </div>
</div>
