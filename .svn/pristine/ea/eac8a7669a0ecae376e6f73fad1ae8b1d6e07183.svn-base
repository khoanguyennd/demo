<?php include(PATH_APPLICATION . 'view/part/popup_mode3_mobi.php'); ?>
<div class="container-fluid paddingleftright" style="position: relative;">
    <div class="header_logo_mobi">
        <div class="logo" style="width: 28%; float: left;text-align: left;padding: 3px 0px 0px 0px;margin: 0px;">
            <img style="width: 140px" src="<?= URL_PUBLIC ?>images/logo-1.png" alt="Billiard">
        </div>
        <div style="width: 32%; float: left; padding-left: 0px !important;">
            <h2 style="padding-top: 12px; text-align: right; font-size: 18px; text-align: center;" class="title_header">
                <?=$this->language("l_mode_record_3_5_mobi")?>
            </h2>
        </div>
        <div style="width: 40%; float: left; padding-left: 0px !important; padding-top: 5px; text-align: right; padding-right: 2px;">
            <a onclick="closeWin()">                    
                <button class="btnblue_endmode">
                    <?= $this->language("l_mode3_endmode") ?>
                </button>
            </a>
            <button class="button_start">
                <?= $this->language("l_start") ?>
            </button>
        </div><div style="clear: both"></div>
    </div><div style="clear: both"></div>
    <div>
        <div class="w-80 m-0 m-auto" style="width: 100% !important;">
            <div class="row main-bgt" style="padding: 2px; margin-left: 0px; margin-right: 0px;">
                <div class="bgt-blue p-0" style="width: 29%; margin-right: 1%;">
                    <div class="title b-line" style="padding: 0px 0px 0px 5px;">
                        <h3 class="titleh3_mobi"><?=$this->language("l_selectmode3")?></h3>
                    </div>
                    <div class="main-ct" style="padding: 5px;">
                        <input type="hidden" id="number_player_mode3" value="3" />
                        <div id="tvgroup3" class="thanh-vien-group box-shadow activetvgroup" onclick="selectmode(3)">
                            <div class="so-thanh-vien text-center b-line-grd w-100"><?=$this->language("l_mode3_3")?></div>
                            <div class="main-so-thanh-vien m-0 m-auto t-line-grd">
                                <div class="w-auto display-table m-0 m-auto g_m_r_35_mobi">	
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                </div>
                            </div>									
                        </div>
                        <div id="tvgroup4" class="thanh-vien-group box-shadow" onclick="selectmode(4)">
                            <div class="so-thanh-vien text-center b-line-grd w-100"><?=$this->language("l_mode3_4")?></div>
                            <div class="main-so-thanh-vien m-0 m-auto t-line-grd">
                                <div class="w-auto display-table m-0 m-auto g_m_r_35_mobi">	
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                </div>
                            </div>									
                        </div>
                        <div id="tvgroup5" class="thanh-vien-group box-shadow" onclick="selectmode(5)">
                            <div class="so-thanh-vien text-center b-line-grd w-100"><?=$this->language("l_mode3_5")?></div>
                            <div class="main-so-thanh-vien m-0 m-auto t-line-grd">
                                <div class="w-auto display-table m-0 m-auto g_m_r_35_mobi">	
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                    <div class="circle-sl"><img src="<?= URL_PUBLIC ?>images/thanh-vien-sl.png"></div>
                                </div>
                            </div>									
                        </div>
                    </div>									
                </div>
                <div class="pr-0 pr-0_mobi" style="width: 70%;">
                    <div class="bgt-blue">
                        <div class="title b-line" style="padding: 0px 0px 0px 5px;">
                            <h3 class="title_h3_content_mobi"><?=$this->language("l_dg_select_name_point")?></h3>
                        </div>
                        <div class="main-ct pt-4" style="padding: 5px 0px 0px 0px !important;">
                            <div class="row rows_selectplayer">
                                <div class="col-md-4 colwidth50 colwidth501" onclick="showpopupuser(1)">
                                    <div class="thanh-vien-item box-shadow">
                                        <div class="w-100 text-center">
                                            <div class="circle-74 float-none m-0 m-auto circle-74_mobi_setting_35">
                                                <img src="<?= URL_PUBLIC ?>images/thanh-vien-1.png">
                                            </div>
                                        </div>
                                        <div class="thanh-vien-ct w-100">
                                            <div class="name-thanh-vien text-center w-100 p-0 lh-40">
                                                <span id="name-thanh-vien1"><?=$this->language("mode3_dg1")?> 1</span>
                                            </div>
                                            <div class="detail_tv">
                                                <div class="w-100 float-left text-center">
                                                    <p class="diem-chap-sm m-0">
                                                        <span class="point point1">10</span>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>	
                                    </div>
                                    <input type="hidden" id="settingname1" value="<?= $this->language("mode3_dg1") ?> 1" />
                                    <input type="hidden" id="settingpoint1" value="10" />
                                </div>
                                <div class="col-md-4 colwidth50 colwidth502" onclick="showpopupuser(2)">                                    
                                    <div class="thanh-vien-item box-shadow">
                                        <div class="w-100 text-center">
                                            <div class="circle-74 float-none m-0 m-auto circle-74_mobi_setting_35"><img src="<?= URL_PUBLIC ?>images/thanh-vien-1.png"></div>
                                        </div>
                                        <div class="thanh-vien-ct w-100">
                                            <div class="name-thanh-vien text-center w-100 p-0 lh-40">
                                                <span id="name-thanh-vien2"><?=$this->language("mode3_dg1")?> 2</span>
                                            </div>
                                            <div class="detail_tv">
                                                <div class="w-100 float-left text-center">
                                                    <p class="diem-chap-sm m-0">
                                                        <span class="point point2">10</span>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>	
                                    </div>
                                    <input type="hidden" id="settingname2" value="<?= $this->language("mode3_dg1") ?> 2" />
                                    <input type="hidden" id="settingpoint2" value="10" />
                                </div>
                                <div class="col-md-4 colwidth50 colwidth503" onclick="showpopupuser(3)">
                                    <div class="thanh-vien-item box-shadow">
                                        <div class="w-100 text-center">
                                            <div class="circle-74 float-none m-0 m-auto circle-74_mobi_setting_35"><img src="<?= URL_PUBLIC ?>images/thanh-vien-1.png"></div>
                                        </div>
                                        <div class="thanh-vien-ct w-100">
                                            <div class="name-thanh-vien text-center w-100 p-0 lh-40">
                                                <span id="name-thanh-vien3"><?=$this->language("mode3_dg1")?> 3</span>
                                            </div>
                                            <div class="detail_tv">
                                                <div class="w-100 float-left text-center">
                                                    <p class="diem-chap-sm m-0">
                                                        <span class="point point3">10</span>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>	
                                    </div>
                                    <input type="hidden" id="settingname3" value="<?= $this->language("mode3_dg1") ?> 3" />
                                    <input type="hidden" id="settingpoint3" value="10" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><div style="clear: both"></div>
    
</div>
<script>
	localStorage.removeItem("secondUseCurrent");
    function selectmode(pos) {
        //alert(pos);
        var number = document.getElementById("number_player_mode3").value;
        var strdiv = '';
        var nameshow = '';
        var pointshow = 0;
        for (var i = 1; i <= pos; i++) {
            if (i <= number) {
                nameshow = document.getElementById("settingname" + i).value;
                pointshow = document.getElementById("settingpoint" + i).value;
            } else {
                if (i == 1) {
                    nameshow = "<?= $this->language("mode3_dg1")?> 1";
                    pointshow = 10;
                }
                if (i == 2) {
                    nameshow = "<?= $this->language("mode3_dg1") ?> 2";
                    pointshow = 10;
                }
                if (i == 3) {
                    nameshow = "<?= $this->language("mode3_dg1") ?> 3";
                    pointshow = 10;
                }
                if (i == 4) {
                    nameshow = "<?= $this->language("mode3_dg1") ?> 4";
                    pointshow = 10;
                }
                if (i == 5) {
                    nameshow = "<?= $this->language("mode3_dg1") ?> 5";
                    pointshow = 10;
                }
            }
            strdiv += '<div class="col-md-4 colwidth50 colwidth50'+i+'" onclick="showpopupuser('+i+')"><div class="thanh-vien-item box-shadow">';
                strdiv += '<div class="w-100 text-center">';
                    strdiv += '<div class="circle-74 float-none m-0 m-auto circle-74_mobi_setting_35"><img src="<?= URL_BASE ?>/public/images/thanh-vien-1.png"></div>';
                strdiv += '</div>';
                strdiv += '<div class="thanh-vien-ct w-100">';
                    strdiv += '<div class="name-thanh-vien text-center w-100 p-0 lh-40"><span id="name-thanh-vien'+i+'">'+nameshow+'</span></div>';
                    strdiv += '<div class="detail_tv">';
                        strdiv += '<div class="w-100 float-left text-center">';
                            strdiv += '<p class="diem-chap-sm m-0">';
                                strdiv += '<span class="point point'+i+'">'+pointshow+'</span>';
                            strdiv += '</p>';
                        strdiv += '</div>';
                    strdiv += '</div>';
                strdiv += '</div>';
            strdiv += '</div>';
            strdiv += '<input type="hidden" id="settingname'+i+'" value="<?= $this->language("mode3_dg1") ?> '+i+'" />';
            strdiv += '<input type="hidden" id="settingpoint'+i+'" value="'+pointshow+'" />';
            strdiv += '</div>';
        }
        document.getElementById("number_player_mode3").value = pos;
        $(".rows_selectplayer:last-child").html(strdiv);
        $(".activetvgroup").removeClass("activetvgroup");
        $("#tvgroup"+pos).addClass("activetvgroup");
    }

    function showpopupuser(pos) {
        var name = document.getElementById("settingname" + pos).value;
        var point = document.getElementById("settingpoint" + pos).value;
        //document.getElementById("name" + pos).value = name;
        //document.getElementById("diem" + pos).value = point;
        $("#usernamepoint" + pos).modal('show');
    }

    function modecancel(pos) {
        $('#usernamepoint' + pos).modal('hide');
    }

    function modeok(pos) {
        var name = document.getElementById("name" + pos).value;
        if(name==""){
            name = "<?= $this->language("mode3_dg1") ?> " + pos;
            /*alert("<?hp// $this->language("mode3_dg3") ?> " + pos);return;*/
        }
        document.getElementById("settingname" + pos).value = name;
        $('#name-thanh-vien' + pos).html(name);
        var diem = document.getElementById("diem" + pos).value;
        if(diem==""){
            diem=10;
        }
        diem = parseInt(diem);
        document.getElementById("settingpoint" + pos).value = diem;
        $('.point' + pos).html(diem);
        $('#usernamepoint' + pos).modal('hide');
    }
</script>
<script type="text/javascript">
    $(document).ready(function() {
        $('.button_start').on('click', function() {
            var number_player = document.getElementById("number_player_mode3").value;
            var error = '';
            var name = '';
            var name1 = '';
            var point = '';
            var strname = '';
            var strpoint = '';
            var namecheck;
            var arr_player = new Array();
            for (var i = 1; i <= number_player; i++) {
                name = document.getElementById("settingname" + i).value;
                point = document.getElementById("settingpoint" + i).value;
                name1 = name.replace(/\s/g, '');
                if (name1 == "") {
                    error += "<?= $this->language("mode3_dg3") ?> " + i + "<br/>";
                }
                if (name == "") {
                    error += "<?= $this->language("mode3_dg3") ?> " + i + "<br/>";
                }
                if (point == "") {
                    error += "<?= $this->language("mode3_dg4") ?> " + i + "<br/>";
                }
                if (parseInt(point) == 0) {
                    error += name +": <?= $this->language("l_mode3_dg5") ?><br/>";
                }
                strname = name + "," + strname;
                strpoint = point + "," + strpoint;
            }
            if (error != '') {
                $("#mess").html(error);
                $('#messModal').modal('show');
            } else {
                strname = strname.slice(0, -1);
                strpoint = strpoint.slice(0, -1);
                $('.div_load_alert').css("display", "block");
                $.fn_ajax('setting3', { 'strname': strname,'strpoint': strpoint,'number_player': number_player}, function(result) {
                    //console.log(result);
                    if (result.flag == true) {
                    	window.location = "<?= $this->route('start3') ?>/"+result.trandau_id;
                    }
                    
                }, true);
            }
        });
    });
</script>

<div class="div_load_alert">
    <div class="main_mess">
        <p><?= $this->language("l_main_mess") ?></p>
        <img style="width: 200px;" src="<?= URL_PUBLIC ?>img/load.gif" />
    </div>
</div>